<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<title>Anypoint Connector Certification Process</title>
<link rel="stylesheet" href="./assets/mule.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Anypoint Connector Certification Process</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a>
<ul class="sectlevel1">
<li><a href="#_about_certification_process">About Certification Process</a></li>
<li><a href="#_stage_1_onboard">Stage 1: OnBoard</a></li>
<li><a href="#_stage_2_development">Stage 2: Development</a></li>
<li><a href="#_stage_3_certify">Stage 3: Certify</a></li>
<li><a href="#_stage_4_publish">Stage 4: Publish</a></li>
<li><a href="#_release_re_certification">Release Re-Certification</a></li>
</ul>
</li>
<li><a href="#_coding_standards_and_best_practices">Coding Standards and Best Practices</a>
<ul class="sectlevel1">
<li><a href="#_code_conventions">Code Conventions</a></li>
<li><a href="#_standard_java_coding_conventions">Standard Java Coding Conventions</a></li>
<li><a href="#_maven_conventions_and_setup">Maven Conventions and Setup</a></li>
<li><a href="#_devkit_standards_and_best_practices">DevKit Standards and Best Practices</a></li>
<li><a href="#_connector_demo_example">Connector Demo Example</a></li>
<li><a href="#_appendix">Appendix</a></li>
</ul>
</li>
<li><a href="#_automated_functional_testing">Automated Functional Testing</a>
<ul class="sectlevel1">
<li><a href="#_approach_explanation">Approach Explanation</a></li>
<li><a href="#_mule_connector_test_framework">mule-connector-test framework</a></li>
<li><a href="#_framework_and_test_suite_components">Framework and Test Suite Components</a></li>
<li><a href="#_suite_implementation">Suite Implementation</a></li>
<li><a href="#_test_methods">Test Methods</a></li>
<li><a href="#_test_cases_classification">Test Cases Classification</a></li>
<li><a href="#_datasense_dynamic_metadata">DataSense (Dynamic metadata)</a></li>
<li><a href="#_test_connection">Test Connection</a></li>
<li><a href="#_transformers">Transformers</a></li>
<li><a href="#_testing_inbound_endpoints_sources">Testing Inbound Endpoints (@Sources)</a></li>
<li><a href="#_setting_up_oauth_authentication">Setting Up OAuth Authentication</a></li>
<li><a href="#_appendix_2">Appendix</a></li>
</ul>
</li>
<li><a href="#_studio_functional_test_plugin">Studio Functional Test Plugin</a>
<ul class="sectlevel1">
<li><a href="#_description">Description</a></li>
<li><a href="#_anypoint_studio_plugin">Anypoint Studio Plugin</a></li>
<li><a href="#_generating_functional_tests">Generating Functional Tests</a></li>
</ul>
</li>
<li><a href="#_studio_interoperability_test_plugin">Studio Interoperability Test Plugin</a>
<ul class="sectlevel1">
<li><a href="#_introduction_2">Introduction</a></li>
<li><a href="#_glossary">Glossary</a></li>
<li><a href="#_installation_2">Installation</a></li>
<li><a href="#_interop_test_run_tutorial">Interop Test Run Tutorial</a></li>
<li><a href="#_appendix_3">Appendix</a></li>
</ul>
</li>
<li><a href="#_static_code_analysis_with_sonarqube">Static Code Analysis with SonarQube</a>
<ul class="sectlevel1">
<li><a href="#_installing_sonarqube">Installing SonarQube</a></li>
<li><a href="#_performing_your_first_analysis">Performing Your First Analysis</a></li>
<li><a href="#_sonarqube_eclipse_plugin_setup">SonarQube Eclipse Plugin Setup</a></li>
<li><a href="#_quality_profile_rules">Quality Profile Rules</a></li>
<li><a href="#_code_coverage">Code Coverage</a></li>
<li><a href="#_studio_plugin_code_coverage_report">Studio Plugin Code Coverage Report</a></li>
<li><a href="#_code_quality_review_guideline">Code Quality Review Guideline</a></li>
</ul>
</li>
<li><a href="#_studio_interoperability_qa">Studio Interoperability QA</a>
<ul class="sectlevel1">
<li><a href="#_purpose">Purpose</a></li>
<li><a href="#_oauth_authentication">OAuth Authentication</a></li>
<li><a href="#_anypoint_studio_interoperability_testing">Anypoint Studio Interoperability Testing</a></li>
<li><a href="#_anypoint_studio_installation">Anypoint Studio Installation</a></li>
<li><a href="#_multiple_extensions">Multiple Extensions</a></li>
<li><a href="#_global_element_properties">Global Element Properties</a></li>
<li><a href="#_connectivity">Connectivity</a></li>
<li><a href="#_metadata">Metadata</a></li>
<li><a href="#_xml_generation">XML Generation</a></li>
<li><a href="#_datamapper_compliance_2">DataMapper Compliance</a></li>
<li><a href="#_datasense_query_editor_dsql">DataSense Query Editor / DSQL</a></li>
<li><a href="#_auto_paging">Auto-Paging</a></li>
<li><a href="#_non_query_operations">Non-Query Operations</a></li>
<li><a href="#_auto_paging_dsql_interoperability">Auto-Paging DSQL Interoperability</a></li>
<li><a href="#_cloudhub_interoperability">CloudHub Interoperability</a></li>
</ul>
</li>
<li><a href="#_templates">Templates</a>
<ul class="sectlevel1">
<li><a href="#_anypoint_connectors_documentation_template">Anypoint Connectors Documentation Template</a></li>
<li><a href="#_anypoint_connectors_release_notes_template">Anypoint Connectors Release Notes Template</a></li>
<li><a href="#_anypoint_connectors_manual_test_suite_template">Anypoint Connectors Manual Test Suite Template</a></li>
<li><a href="#_certification_checklist">Certification Checklist</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><strong>version 0.9</strong></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>MuleSoft has expanded the Anypoint™ Connector offering to enable third-party developers and partners to develop Anypoint Connectors.
All connectors enrolled in the MuleSoft Partner Program must go through a mandatory periodic Certification Process. The Certification Process has been developed to assess the quality of connectors, to ensure that connectors published on the MuleSoft Web page follow industry best practices for development, and to promote trust.
All connectors built by external developers and/or partners go through a Certification Process conducted by MuleSoft’s internal team. Once a connector passes certification, the connector is branded as a MuleSoft-certified connector and published on the MuleSoft web site.</p>
</div>
<div class="paragraph">
<p>The scope of the certification process depends on the composition of the connector. Our approach is to test all parts of the connector to ensure that our mutual customers and their platforms are not put at risk.
The items below are a list of the high-level testing performed on each connector during the certification process:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Automated code scan</p>
</li>
<li>
<p>Manual code review and black box testing</p>
</li>
<li>
<p>Manual and automated tests review</p>
</li>
<li>
<p>Repository structure review</p>
</li>
<li>
<p>Documentation review</p>
</li>
<li>
<p>Compatibility review</p>
</li>
<li>
<p>Static code analysis</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the following sections, each one of the topics to be completed as part of the certification will be described.</p>
</div>
<div class="sect1">
<h2 id="_about_certification_process">About Certification Process</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The partner Engagement and Certification Process for publishing connectors consists of these stages:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/certification-process-1.png" alt="certification process 1">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stage_1_onboard">Stage 1: OnBoard</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_1_1_legal_engagement">1.1 Legal Engagement</h3>
<div class="paragraph">
<p>During the development process, MuleSoft and a third-party partner, based on a pre-existing partnership agreement, begin the development process.</p>
</div>
</div>
<div class="sect2">
<h3 id="_1_2_leaning_anypoint_connector_devkit">1.2 Leaning Anypoint™ Connector DevKit</h3>
<div class="paragraph">
<p>The MuleSoft Anypoint™ Connector DevKit is the tool for developing Anypoint Connectors. It provides the following features to help you develop or maintain a connector:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Visual design and implementation using Anypoint Studio with an Eclipse-oriented interface that helps simplify and speed up development</p>
</li>
<li>
<p>Maven support for development and building</p>
</li>
<li>
<p>Connector development and packaging tools</p>
</li>
<li>
<p>Authentication support for multiple types of authentication like OAuth and Basic Authentication</p>
</li>
<li>
<p>DataSense support to acquire metadata from endpoints</p>
</li>
<li>
<p>Extensive testing capability</p>
</li>
<li>
<p>Examples, training, and support to simplify startup and solve issues</p>
</li>
<li>
<p>Provides Batch, query pagination, and DataSense Query Language support</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>There is plenty of documentation on Internet about DevKit. Here is a set of links that it could be useful as starting point:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Connector Development Essential: <a href="http://training.mulesoft.com/instructor-led-training/connector-development-essentials-private-class-ilt" class="bare">http://training.mulesoft.com/instructor-led-training/connector-development-essentials-private-class-ilt</a></p>
</li>
<li>
<p>Official DevKit Documentation: <a href="http://www.mulesoft.org/documentation/display/current/Anypoint+Connector+DevKit" class="bare">http://www.mulesoft.org/documentation/display/current/Anypoint+Connector+DevKit</a></p>
</li>
<li>
<p>DevKit Tutorial: <a href="http://www.mulesoft.org/documentation/display/current/Tutorial+-+Barn+Connector" class="bare">http://www.mulesoft.org/documentation/display/current/Tutorial+-+Barn+Connector</a></p>
</li>
<li>
<p>Community Forum: <a href="http://forum.mulesoft.org/mulesoft/products/mulesoft_anypoint_connectors" class="bare">http://forum.mulesoft.org/mulesoft/products/mulesoft_anypoint_connectors</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stage_2_development">Stage 2: Development</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_2_1_design_specification_review">2.1 Design Specification Review</h3>
<div class="paragraph">
<p>The spirit of this document is to help the MuleSoft certification team to have an initial context about the connector to be develop.
MuleSoft certification team will use this document as a starting point to provide feedback and tips about the best use of DevKit and suggesting development patterns.</p>
</div>
<div class="paragraph">
<p>The follow template must be used as starting point
<a href="https://github.com/mulesoft/connector-certification-docs/blob/docs/current/attachments/templates/designSpecificationTemplate.adoc">Design Specification Template</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_2_2_mandatory_practices">2.2  Mandatory Practices</h3>
<div class="paragraph">
<p>In order to quality of the connectors developed, there are a set of practices and artifacts that need to be delivered as part of the connectors development.
Each one of the following practices are aimed to cover different quality aspects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://mulesoft.github.io/connector-certification-docs/current/user-manual.html#_development_best_practices">Coding Standards and Best Practices</a></p>
</li>
<li>
<p><a href="http://mulesoft.github.io/connector-certification-docs/current/user-manual.html#_static_code_analysis_with_sonarqube">Static Code Analysis &amp; Code Coverage</a></p>
</li>
<li>
<p><a href="http://mulesoft.github.io/connector-certification-docs/current/user-manual.html#_automated_functional_testing">Automated Functional Testing</a></p>
</li>
<li>
<p><a href="http://mulesoft.github.io/connector-certification-docs/current/user-manual.html#_studio_interoperability_qa"> Anypoint Studio  Interoperability Testing</a></p>
</li>
<li>
<p><a href="http://mulesoft.github.io/connector-certification-docs/current/user-manual.html#_templates">Connector Release Notes &amp; Documentation</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stage_3_certify">Stage 3: Certify</h2>
<div class="sectionbody">
<div class="paragraph">
<p>At this stage, the connector is really to go over the final stage of the certification.</p>
</div>
<div class="sect2">
<h3 id="_3_1_prerequisites">3.1 Prerequisites</h3>
<div class="paragraph">
<p>Before Mule start the certification process, there are a set of prerequisites to be satisfied:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Design Specification Approved:</strong> Design Specification has been approved and all suggested correction has been completed.</p>
</li>
<li>
<p><strong>Source Code Access and Sandbox Credentials:</strong> As part of the certification, MuleSoft will internally run a continue build tests execution and run a set of code inspections to validate the quality of the connector. The next actions are required:</p>
<div class="ulist">
<ul>
<li>
<p>GitHub account read access must be granted to the user connectors-cert-ci (<a href="mailto:connectors-cert-ci@mulesoft.com">connectors-cert-ci@mulesoft.com</a>)</p>
</li>
<li>
<p>In case of being required, provide the Sandbox credentials a .properties used for the testing execution.</p>
</li>
<li>
<p>Create a release branch that will contain all the fixes and suggested during the certification. It should follows the naming convention "release/v&lt;version-number&gt;". Once the certification process has been completed, all the changes will be merged into the master branch and a tag will all the change must be created. It&#8217;s strongly encourage to follow GitFlow branching practices.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Maven Dependencies:</strong> It&#8217;s important that the following things be satisfied:</p>
<div class="ulist">
<ul>
<li>
<p>Connector must be a final version, It could not be an SNAPSHOT</p>
</li>
<li>
<p>There must not be SNAPSHOT dependencies</p>
</li>
<li>
<p>External dependencies must be located in well know public repositories.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Presentation Demo:</strong> The objective of this demo is to go over the functional aspects of the connectors, overview of the system to be connected, underlying integration technology (REST/WSDL/SDK). The audience of this meeting will be Product Managers , Connectors Engineers Leads and QA.</p>
</li>
<li>
<p><strong>Complete Certification Checklist:</strong> Before the connector could start the certification process, it’s responsibility of the partner to validate that all the certification artifacts and requirements have been accomplished. All the required actions are described in the following template and should be completed before submitting the connector for certification. Certification checklist could be found <a href="https://drive.google.com/file/d/0B8N265C555thOG5HZDRTOTEtUXM/view?usp=sharing">here</a></p>
</li>
<li>
<p><strong>Connector documentation:</strong> There must be a public access to the connectors documentation.</p>
</li>
<li>
<p><strong>Versioning:</strong> Connectors must follow versioning best practices. Given a version number MAJOR.MINOR.PATCH increment MAJOR version when you make incompatible API changes,increment MINOR version when you add functionality in a backwards-compatible manner, and increment PATCH version when you make backwards-compatible bug fixes.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_3_2_certifying">3.2 Certifying</h3>
<div class="paragraph">
<p>Once all the previous steps have been completed, MuleSoft engineering team will start running the certification and creating a set of recommendations to be completed before the connector could be released. This is an iterative process where it’s highly probable that our engineering team will have questions about the connector usage. It’s strongly recommended to allocate some time from developers in case of any question arise. Once all the certification criteria has been meet, the connector is ready to move to the next stage. As part of this, the connector forum will be used a the communication chanel between the partner an MuleSoft.</p>
</div>
<div class="paragraph">
<p>MuleSoft will provide a tentative day for starting the certification. We strongly encourage to allocate some development time to start working on the suggested connections and changes. If there is not active partner engagement and activity on fixing the issue in a period of 7 days, the certification will be suspended and a new tentative day will be assigned.</p>
</div>
<div class="paragraph">
<p>MuleSoft will provide a CloudBees (<a href="http://www.cloudbees.com" class="bare">http://www.cloudbees.com</a>) private account that the partner will use to monitor the nightly tests execution and static code analysis reports. It&#8217;s responsibility of the partner to monitor warranty sandbox maintenance and successful tests results.</p>
</div>
<div class="paragraph">
<p>MuleSoft reserves the right to conduct random tests on published connectors. If we find a connector that deviates from any of our requirements, we notify you and provide a timeframe to remedy the issue. In extreme cases, we may remove the connector from our web site.</p>
</div>
</div>
<div class="sect2">
<h3 id="_3_3_results">3.3 Results</h3>
<div class="ulist">
<ul>
<li>
<p><strong>Support Training:</strong> Mule Support team will provide T1 support and will help the customer to isolated the issue to identify if the issue is a Mule issue or a connector issue. The objective of this birth view training is to provide to the support team a general understanding of the connector and tools that help to isolate the problem.</p>
</li>
<li>
<p><strong>Upload to Library:</strong> Connector will be upload in the <a href="https://www.mulesoft.com/library">Mule Connectors Library</a>. After your connector passes the Certification Process, MuleSoft sends you an estimated date for when your connector will appear on the MuleSoft web site. As part of this process, the following information need to be provided:</p>
<div class="ulist">
<ul>
<li>
<p>High Level description of the connector. SalesForce connector could be use a template example: <a href="https://www.mulesoft.com/library#!/salesforce-integration-connector?types=connector" class="bare">https://www.mulesoft.com/library#!/salesforce-integration-connector?types=connector</a></p>
</li>
<li>
<p>URL to Release Notes</p>
</li>
<li>
<p>URL to Functional documentation of the connector</p>
</li>
<li>
<p>URL to DevKit generated documentation</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_stage_4_publish">Stage 4: Publish</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Finally, the connector will be available in MueSoft Connector Library (<a href="https://www.mulesoft.com/library" class="bare">https://www.mulesoft.com/library</a>)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_release_re_certification">Release Re-Certification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mule ESB and Anypoint Studio have a release cadence of 3 month cycles. Even the fact that Mule ESB and Mule Studio will be focus on maintaining forward compatibility for all develop connectors there is a small probability that issues related to classloader problems or data mapping could arise. Due to that, it’s required that a regression testing using the released version of Mule ESB and Mule Studio be executed. Early access to binaries will be provided to run the re-certification. It’s important to point out that the certification must be run over the already released connector</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_coding_standards_and_best_practices">Coding Standards and Best Practices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section is about best development practices, these are a set of rules that the connector development community has learned over time which can help improve the quality of your connector.</p>
</div>
<div class="sect1">
<h2 id="_code_conventions">Code Conventions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This sections covers the following areas:</p>
</div>
<div class="paragraph">
<p>Standard Java Coding Conventions
. DevKit Standards and Best Practices
. Maven Conventions and Setup
. Connector Demo Example</p>
</div>
<div class="paragraph">
<p>It&#8217;s important to point out that in the following steps of the certification most of this practices will be validated using automated tools such as SonarQue.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_standard_java_coding_conventions">Standard Java Coding Conventions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_static_analysis_rules">Static Analysis Rules</h3>
<div class="paragraph">
<p>We have defined as set of static inspections rules that are enforced by SonarQube. This rules are aimed to detect potential bugs and bad coding practices.
More details about this could be found in the section <a href="http://mulesoft.github.io/connector-certification-docs/current/user-manual.html#_static_code_analysis_with_sonarqube">Static Code Analysis &amp; Code Coverage</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_maven_conventions_and_setup">Maven Conventions and Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following section describes set of conventions and best practices to follow at the time to define your connector Maven project structure.</p>
</div>
<div class="sect2">
<h3 id="_best_practices">Best Practices</h3>
<div class="paragraph">
<p>These are mandatory practices to be honored:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Follow Maven default name conventions <a href="http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html" class="bare">http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html</a></p>
</li>
<li>
<p>Do not overwrite org.mule.tools.devkit:mule-devkit-parent properties.</p>
</li>
<li>
<p>Do not reference SNAPSHOT dependencies either in plugins or dependencies.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_connector_structure">Connector Structure</h3>
<div class="paragraph">
<p>If you create your connector project using the DevKit Studio Plugin, the structure generates by default is the recommended approach.
If you are interested in more details, the project directory structure are described in the <em>Appendix C</em>.</p>
</div>
<div class="paragraph">
<p>In order to provide automatic enforcement of this rules, the following plugin must be configure as part of the connectors pom.xml. I will be responsible for validating the project structure.
Copy and paste the following snippets in your connector pom.xml:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;build&gt;</span>
    ...
    <span class="tag">&lt;plugins&gt;</span>
        ...
       <span class="tag">&lt;plugin&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.mule.certification<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>project-structure-validation<span class="tag">&lt;/artifactId&gt;</span>
            <span class="tag">&lt;version&gt;</span>1.0.4<span class="tag">&lt;/version&gt;</span>
            <span class="tag">&lt;executions&gt;</span>
                <span class="tag">&lt;execution&gt;</span>
                    <span class="tag">&lt;phase&gt;</span>package<span class="tag">&lt;/phase&gt;</span>
                    <span class="tag">&lt;goals&gt;</span>
                        <span class="tag">&lt;goal&gt;</span>y<span class="tag">&lt;/goal&gt;</span>
                    <span class="tag">&lt;/goals&gt;</span>
                <span class="tag">&lt;/execution&gt;</span>
            <span class="tag">&lt;/executions&gt;</span>
        <span class="tag">&lt;/plugin&gt;</span>
        ...
    <span class="tag">&lt;/plugins&gt;</span>
    ...
<span class="tag">&lt;/build&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_devkit_standards_and_best_practices">DevKit Standards and Best Practices</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_datamapper_compliance">DataMapper Compliance</h3>
<div class="paragraph">
<p>To have the best experience in Anypoint Studio, connectors must be DataMapper compliant. To achieve this, all operations must follow these recommendations.</p>
</div>
<div class="paragraph">
<p>Any argument, returned or received, must be one of the following data types:
. Map
. POJO
. List&lt;Map&gt;
. List&lt;String&gt;
. List&lt;POJO&gt;
. List&lt;List&lt;String&gt;&gt;</p>
</div>
<div class="paragraph">
<p>These types must be part of the method signature so that DataMapper can auto-recognize the types in it&#8217;s mapping UI.</p>
</div>
<div class="paragraph">
<p><em>Important</em>: Only use a map if you cannot use a POJO.
Only use a map if your data:
. Is schemaless, for example if created using MongoDB.
. Has user customizable schemas, if created with Salesforce.
. Has unknown content.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Good Example</th>
<th class="tableblock halign-left valign-top">Bad Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">List&lt;Map&gt; query()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List&lt;DBObject&gt; query</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void send(Invoice invoice)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">void send(Object object)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Invoice getInvoice(String id)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Object get(String id, Class typeToCreate)
</p><p class="tableblock">All operations must have a single object to take input from DataMapper. The object must be a single object, not multiple arguments. This object is called the Primary argument.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Good Example</th>
<th class="tableblock halign-left valign-top">Bad Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void createInvoice(Invoice invoice)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">createInvoice(Header header, List&lt;LineItems&gt; lineItems)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">void upsert(List&lt;Map&gt; sobjects, String type, String externalFieldId)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A - Multiple arguments are still needed!</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetTaxResult getTax(TaxRequest request)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><code>public GetTaxResult getTax(String companyCode,<br>
    AvalaraDocumentType docType,<br>
    @Optional String docCode,<br>
    Date docDate,<br>
    @Optional String salespersonCode,<br>
    String customerCode,<br>
    @Optional String customerUsageType,<br>
    String discount,<br>
    @Optional String purchaseOrderNo)<br>
</code></code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_annotations">Annotations</h3>
<div class="paragraph">
<p>If you have multiple arguments, annotate the Primary argument with:</p>
</div>
<div class="paragraph">
<p><code>@Default("#[payload]")</code></p>
</div>
<div class="paragraph">
<p>This way DataMapper knows which argument in the operation to use for mapping.</p>
</div>
</div>
<div class="sect2">
<h3 id="_devkit_generated_api_doc">DevKit Generated API Doc</h3>
<div class="paragraph">
<p>Connector documentation is composed of two different type of documentation: DevKit Generated DevKit API Doc and the Connector Documentation.</p>
</div>
<div class="paragraph">
<p>DevKit API Doc is automatically generated by DevKit based on the JavaDoc documentation at the connector class. This is one of the most important information used by the developer at the time of of using the connector.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connector_demo_example">Connector Demo Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A Mule application&#8217;s endpoints allow a user to interact with the service and API using the connector. Endpoints are committed to the GitHub repository along with source code. Use services or API use cases to determine which connector operations to select.</p>
</div>
<div class="paragraph">
<p>Creation criteria:
. Ensure that an app can be run by entering credentials without additional configuration or connector installation.
. Use placeholders for credentials.
. Ensure that flow names and message processors display names that make the use case easy to understand.
. Provide instructions on how to run the app in the README.md file of the GitHub demo (example <a href="https://github.com/mulesoft/sqs-connector/tree/master/demo">SQS</a>).
. Expose a set of endpoints that the user can access following the steps in the README.md to reproduce a use case. An example is the <a href="https://github.com/mulesoft/sqs-connector/tree/master/demo">SQS</a> demo.
. Consider implementing a CRUD (or similar) use case with chained processors whose payloads get logged into the Studio console (for example, <a href="https://github.com/mulesoft/s3-connector/tree/master/demo/s3connectorstudiodemo">S3</a>).
. Use DataMapper for Standard or Premium connectors' CRUD (or a similar) use case if API methods attributes and/or return types allow it.
. Consider basic error handling in the Mule app.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix">Appendix</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://github.com/mulesoft/connector-certification-docs/blob/docs/current/attachments/development/appendixA.adoc">Appendix A</a></p>
</li>
<li>
<p><a href="https://github.com/mulesoft/connector-certification-docs/blob/docs/current/attachments/development/appendixB.adoc">Appendix B</a></p>
</li>
<li>
<p><a href="https://github.com/mulesoft/connector-certification-docs/blob/docs/current/attachments/development/appendixC.adoc">Appendix C</a></p>
</li>
<li>
<p><a href="https://github.com/mulesoft/connector-certification-docs/blob/docs/current/attachments/development/appendixD.adoc">Appendix D</a></p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_automated_functional_testing">Automated Functional Testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section explains how to automate functional test cases on Connectors.</p>
</div>
<div class="sect1">
<h2 id="_approach_explanation">Approach Explanation</h2>
<div class="sectionbody">
<hr>
<div class="sect2">
<h3 id="_objectives">Objectives</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Automation test suite integrated to the connector.</p>
</li>
<li>
<p>Real sandbox and Mule server used when running the tests.</p>
</li>
<li>
<p>Automation test suite maintenance is minimal.</p>
</li>
<li>
<p>Outdated automation suite doesn&#8217;t affect development.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_test_creation_criteria">Test Creation Criteria</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Launch and shut a Mule instance for each test to ensure isolation from the rest of a suite.</p>
</li>
<li>
<p>Use the <code>setUp()</code> method to create a test fixture prior to running an actual test.</p>
</li>
<li>
<p>Create entities to test each operation.</p>
</li>
<li>
<p>Use beans in a Spring file to separate tests from input test data values.</p>
</li>
<li>
<p>Make tests flexible enough to support all possible entities and the amount of them (if applicable).</p>
</li>
<li>
<p>Only update tests when business logic changes in an operation, or when you modify the operation itself, such as when a signature changes.</p>
</li>
<li>
<p>Provide one Mule flow for each operation. Use Java code to glue operations into more complex use cases.</p>
</li>
<li>
<p>Clean up tests after each completes, and leave the sandbox in the state prior to running a test.</p>
</li>
<li>
<p>Tests should clean up after themselves. Sandbox should be left in the state prior to running the test.</p>
</li>
<li>
<p>Test only one thing at a time.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_coverage_categories">Coverage Categories</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Use a smoke suite</strong> to ensure test preconditions are met for a Regression run.</p>
</li>
<li>
<p><strong>Use a regression suite</strong> to include at least one test case for each operation. Take input on this kind of test from a Mule Message, ensure a test is fully parameterized, and only modify data from the AutomationSpringBeans.xml file.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mule_connector_test_framework">mule-connector-test framework</h2>
<div class="sectionbody">
<hr>
<div class="sect2">
<h3 id="_objectives_2">Objectives</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Provide consistent test suite implementation through the different connectors business models.</p>
</li>
<li>
<p>Increase code reusability.</p>
</li>
<li>
<p>Improve test case readability by encapsulating complexities.</p>
</li>
<li>
<p>Reduce maintenance cost.</p>
</li>
<li>
<p>Increase robustness by isolating test suite implementation from Mule classes changes.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_concepts">Concepts</h3>
<div class="paragraph">
<p>Use cases are built as a sequence of connector operations calls. Prior to running a use case, initialize a TestRunMessage and load the data required by the use case. After you invoke an operation, turn the content of the TestRunMessage into a MuleEvent before an operation consumes the content. Apply asserts to the payload of the operation under the test.</p>
</div>
</div>
<div class="sect2">
<h3 id="_maven_dependency">Maven Dependency</h3>
<div class="paragraph">
<p>mule-devkit-parent contains the framework version property (that can, if necessary, be overridden on the connector pom) and its dependency node.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;properties&gt;</span>
   ...
   <span class="tag">&lt;connector.test.version&gt;</span>2.0.6<span class="tag">&lt;/connector.test.version&gt;</span>
<span class="tag">&lt;/properties&gt;</span>

<span class="comment">&lt;!-- Mule Connector Test Framework --&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
   <span class="tag">&lt;groupId&gt;</span>org.mule.modules<span class="tag">&lt;/groupId&gt;</span>
   <span class="tag">&lt;artifactId&gt;</span>mule-connector-test<span class="tag">&lt;/artifactId&gt;</span>
   <span class="tag">&lt;version&gt;</span>${connector.test.version}<span class="tag">&lt;/version&gt;</span>
   <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_framework_and_test_suite_components">Framework and Test Suite Components</h2>
<div class="sectionbody">
<hr>
<div class="sect2">
<h3 id="_connectortestcase_class">ConnectorTestCase Class</h3>
<div class="paragraph">
<p>ConnectorTestCase class inherits from <strong>org.mule.tck.junit4.FunctionalTestCase</strong> and wraps FunctionalTestCase methods into methods that both facilitate automating connectors operations use cases and enforce a uniform approach on the construction of test suites. ConnectorTestCase is by <strong>&lt;Connector&gt;TestParent.java</strong> and this class is the parent test class for all of the test cases.</p>
</div>
</div>
<div class="sect2">
<h3 id="_connectortestutils_class">ConnectorTestUtils Class</h3>
<div class="paragraph">
<p>Provides methods for working with <em>NullPayload</em>, initializing random test data and also manipulating the date in the Spring file. Also enhances the exception message that displays for more accurate debugging.</p>
</div>
</div>
<div class="sect2">
<h3 id="__connector_testparent_class">&lt;Connector&gt;TestParent Class</h3>
<div class="paragraph">
<p>Extends the ConnectorTestCase class. You can use this class to override default framework configuration settings, add OAuth capabilities, implement helper methods, and store global settings, such as testing run time out rules.</p>
</div>
<div class="paragraph">
<p>You can define common use cases for the service as class methods to make them available to the rest of the test suite. This makes tests more readable and associates a test with a connector&#8217;s domain.</p>
</div>
<div class="paragraph">
<p>All TestCases classes must extend from this TestParent.</p>
</div>
</div>
<div class="sect2">
<h3 id="__operationname_testcases_class">&lt;OperationName&gt;TestCases Class</h3>
<div class="paragraph">
<p><strong>Note:</strong> Do not allow automation tests to be automatically run by Maven because the tests require credentials. Follow the naming conventions for an automation test.</p>
</div>
<div class="paragraph">
<p>Each operation in the connector has an <strong>&lt;OperationName&gt;TestCases.java</strong> class that contains its related test cases. The sequence of operations called along the <strong>@Before-@Test-@After</strong> cycle make an operation use case.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> &lt;<span class="class">OperationName</span>&gt;TestCases <span class="directive">extends</span> &lt;ConnectorName&gt;TestParent {

   <span class="comment">// private attributes used as auxiliary fields for storing test run values</span>
   <span class="directive">private</span> <span class="predefined-type">Integer</span> leadRecordId;

   <span class="comment">// creates the test fixture</span>
   <span class="annotation">@Before</span>
   <span class="directive">public</span> <span class="type">void</span> setUp() <span class="directive">throws</span> <span class="exception">Exception</span> {
     ...
   }

   <span class="comment">// returns the sandbox to its original state</span>
   <span class="annotation">@After</span>
   <span class="directive">public</span> <span class="type">void</span> tearDown() <span class="directive">throws</span> <span class="exception">Exception</span> {
      ...
   }

   <span class="comment">// method that invokes the flow of the operation under test and asserts on its payload</span>
   <span class="annotation">@Category</span>({SmokeTests.class, RegressionTests.class})
   <span class="annotation">@Test</span>
   <span class="directive">public</span> <span class="type">void</span> test&lt;operationName&gt;() {
      <span class="keyword">try</span> {
         ...
      } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
         fail(ConnectorTestUtils.getStackTrace(e));
      }
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_test_resources">Test Resources</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>AutomationSpringBeans.xml</strong> contains the maps and POJOs required by the tests to run.</p>
</li>
<li>
<p><strong>automation-test-flows.xml</strong> is a collection of flows, each containing a connector operation, that invoke on the tests.</p>
</li>
<li>
<p><strong>automation-credentials.properties</strong> stores the connector credentials and authenticated user related information.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_test_runners">Test Runners</h3>
<div class="paragraph">
<p>Run different sets of tests with the aid of runners. Test cases are classified into two categories:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Smoke</strong>: Tests that verify operations used on @Before and @After methods, thus assuring that it makes sense to run a test suite.</p>
</li>
<li>
<p><strong>Regression</strong>: Positive test on the operation attributes that you pass from a Message.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_suite_implementation">Suite Implementation</h2>
<div class="sectionbody">
<hr>
<div class="sect2">
<h3 id="_test_development_environment_set_up">Test Development Environment Set Up</h3>
<div class="paragraph">
<p>After building a connector, add <strong>target/generated-sources/mule</strong> to the project build path. You may need to add other generated sources to the build path depending on the connector (such as target/generated-sources/cxf).</p>
</div>
<div class="paragraph">
<p>If a connector is <strong>Standard</strong>, add a <strong>muleLicenseKey.lic</strong> to the <strong>src/test/resources</strong> folder and remove it prior to committing your changes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_packages_and_files">Packages and Files</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>org.mule.modules.&lt;connector-project&gt;.automation</strong> contains the <strong>&lt;Connector&gt;TestParent</strong> and the <em>SmokeTests</em> and <em>RegressionTests</em> categories interfaces.</p>
</li>
<li>
<p><strong>org.mule.modules.&lt;connector-project&gt;.automation.testrunners</strong> contains the runners (RegressionTestSuite, SmokeTestSuite).</p>
</li>
<li>
<p><strong>org.mule.modules.&lt;connector-project&gt;.automation.testcases</strong> contains the functional test cases exclusively.</p>
</li>
<li>
<p><strong>&lt;connector-project&gt;/src/test/resources</strong> contains automation flows, credentials and Spring beans files:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong>AutomationSpringBeans.xml</strong></p>
</li>
<li>
<p><strong>automation-test-flows.xml</strong></p>
</li>
<li>
<p><strong>automation-credentials.properties</strong></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_automation_flows">Automation Flows</h3>
<div class="paragraph">
<p>For each operation, place a maximum of two flows in the <strong>automation-test-flows</strong> file. One flow is for mandatory attributes. This ensures that you implement all mandatory arguments in a connector and if applicable, use another flow with all attributes (mandatory and optional), to build a more general case for the operation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_automation_test_flows_xml_and_operation_attributes">automation-test-flows.xml and Operation Attributes</h3>
<div class="paragraph">
<p>Each operation in the connector has at least a corresponding flow in the automation-test-flows file. The flow and its associated operation should be thought of as resources that can be called from multiple tests. Flow names are the same as the operation they contain or at least start with the name of the operation they contain, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;operation-name</span></span><span class="error">&gt;</span>&quot; doc:name=&quot;<span class="tag">&lt;operation-name&gt;</span>&quot;<span class="error">&gt;</span>
  <span class="tag">&lt;marketo:</span><span class="error">&lt;</span><span class="attribute-name">operation-name</span><span class="tag">&gt;</span>
    config-ref=&quot;<span class="tag">&lt;ConfigName&gt;</span>&quot;
    doc:name=&quot;<span class="tag">&lt;operation-name&gt;</span>&quot;  … /<span class="error">&gt;</span>
<span class="tag">&lt;/flow&gt;</span>

<span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;operation-name</span></span><span class="error">&gt;</span>-<span class="tag">&lt;particular-case&gt;</span>&quot; doc:name=&quot;<span class="tag">&lt;operation-name&gt;</span>&quot;<span class="error">&gt;</span>
  <span class="tag">&lt;marketo:</span><span class="error">&lt;</span><span class="attribute-name">operation-name</span><span class="tag">&gt;</span>
    particularCaseAttribute=&quot;#[flowVars.attributeName]&quot;
    config-ref=&quot;<span class="tag">&lt;ConfigName&gt;</span>&quot;
    doc:name=&quot;<span class="tag">&lt;operation-name&gt;</span>&quot;  … /<span class="error">&gt;</span>
<span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Populate operation attributes as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">attributeName=&quot;#[flowVars.attributeName]&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;taleo:</span><span class="error">&lt;</span><span class="attribute-name">entityName</span><span class="tag">&gt;</span> ref=&quot;#[flowVars.<span class="tag">&lt;entityName&gt;</span>Ref]&quot;/<span class="error">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the case of being given the choice of passing non-primitive types (e.g. POJOs, List&lt;POJOs&gt;, Map&lt;POJOs&gt;, etc.) either from the payload, by reference, or by manually creating it using Anypoint Studio, either taking the value from the payload or by reference should be selected.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="comment">&lt;!-- mobjects value passed by as reference --&gt;</span>
<span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sync-mobjects</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sync-mobjects</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;marketo:sync-mobjects</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Marketo</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Sync MObjects</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">operation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[flowVars.operation]</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[flowVars.type]</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;marketo:mobjects</span> <span class="attribute-name">ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[flowVars.mobjectsRef]</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/marketo:sync-mobjects&gt;</span>
<span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="comment">&lt;!-- mobject value taken from payload --&gt;</span>
<span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sync-mobjects</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sync-mobjects</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;marketo:sync-mobjects</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Marketo</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Sync MObjects</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">operation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[flowVars.operation]</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[flowVars.type]</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_keeping_headers_updated">Keeping Headers Updated</h3>
<div class="paragraph">
<p>Change the connector version to current to avoid breaking the configuration XML file, for example,</p>
</div>
<div class="paragraph">
<p>from: <code><a href="http://www.mulesoft.org/schema/mule/taleo/1.0-SNAPSHOT/mule-taleo.xsd" class="bare">http://www.mulesoft.org/schema/mule/taleo/1.0-SNAPSHOT/mule-taleo.xsd</a></code></p>
</div>
<div class="paragraph">
<p>To: <code><a href="http://www.mulesoft.org/schema/mule/taleo/current/mule-taleo.xsd" class="bare">http://www.mulesoft.org/schema/mule/taleo/current/mule-taleo.xsd</a></code></p>
</div>
</div>
<div class="sect2">
<h3 id="_credentials">Credentials</h3>
<div class="ulist">
<ul>
<li>
<p>Choose connector credentials from the automation-credential.properties file during test development, or if tests are to be run from within Eclipse.</p>
</li>
<li>
<p>Populate the config element field with placeholders using:
<code>configRefAttribute="${serviceName.configRefAttribute}"</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;marketo:config</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Marketo</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">userId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${marketo.userId}</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${marketo.key}</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">endpointUrl</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${marketo.endpointUrl}</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Marketo</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;marketo:connection-pooling-profile</span> <span class="attribute-name">initialisationPolicy</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INITIALISE_ONE</span><span class="delimiter">&quot;</span></span>
     <span class="attribute-name">exhaustedAction</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WHEN_EXHAUSTED_GROW</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/marketo:config&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Create a Property placeholder that references automation-credentials.properties or add the following as an attribute to the Mule node:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>xmlns:context="http://www.springframework.org/schema/context"</code></p>
</div>
<div class="paragraph">
<p>Or add this as one of its child nodes:</p>
</div>
<div class="paragraph">
<p><code>&lt;context:property-placeholder location="automation-credentials.properties" /&gt;</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Prior to committing, change the location value to:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>&lt;context:property-placeholder location="${&lt;CONNECTOR_NAME&gt;_CREDENTIALS}" /&gt;</code></p>
</div>
<div class="paragraph">
<p>This lets you run the suites from the console or build plan by passing the URL where the automation-credentials.properties are stored.</p>
</div>
</div>
<div class="sect2">
<h3 id="_test_data_using_spring_beans">Test Data Using Spring Beans</h3>
<div class="paragraph">
<p>AutomationSpringBeans stores the test data required for each test to run.</p>
</div>
<div class="paragraph">
<p>The most common case is to have a &lt;testMethod&gt;TestData map containing all the primitive values or bean references for a specific test. For more complex cases, additional beans for the test may be required besides the main TestData map.</p>
</div>
<div class="paragraph">
<p>The approach is that each test has its set of dedicated test values, hence the convention. Reusing the same bean on different test results in them being coupled; if some specific data setup is desired for a particular test, changes might end up producing an unexpected behavior on others.</p>
</div>
<div class="paragraph">
<p>By convention all bean IDs related to an operation should begin with the operation name followed by the bean class. This avoids naming conflicts and makes clear which operation this bean uses.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="comment">&lt;!--  get-lead --&gt;</span>
<span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">testGetLeadLeadKey</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">com.marketo.mktows.LeadKey</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">keyType</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;util:constant</span> <span class="attribute-name">static-field</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">com.marketo.mktows.LeadKeyRef.IDNUM</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
   <span class="tag">&lt;/property&gt;</span>
<span class="tag">&lt;/bean&gt;</span>

<span class="tag">&lt;util:map</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">testGetLeadLeadRecord</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">scope</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">prototype</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">City</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">city</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
   <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Company</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">company_title</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
   <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Country</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">country</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
   <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">FirstName</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">first_name</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
   <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">LastName</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">last_name</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
   <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">MobilePhone</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">cell_phone</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
   <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Phone</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">work_phone</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
   <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">State</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">state</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
   <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Title</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">job_title</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/util:map&gt;</span>

<span class="comment">&lt;!--  testGetLead method TestData map --&gt;</span>
<span class="tag">&lt;util:map</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">testGetLeadTestData</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">scope</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">prototype</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">LeadRecord</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/util:map&gt;</span></code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In spring use scope="prototype" (if applicable) to ensure values from previous tests (ids, etc) are not reused in the following tests.</p>
</li>
<li>
<p>"TestData" map can be used to store expected results for a test in case the expected value relates to the data been passed to them.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;util:map</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">createBatchAttendeeListTestData</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">map-class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.util.HashMap</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">key-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.String</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.Object</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">scope</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">prototype</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">payloadContent</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">attendeeBatch</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">batchType</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CREATE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">expectedRecordsSucceeded</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/util:map&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testCreateBatchAttendeeList() {
       ...
 assertEquals(payload.getRecordsSucceeded(),
   getTestRunMessageValue(<span class="string"><span class="delimiter">&quot;</span><span class="content">expectedRecordsSucceeded</span><span class="delimiter">&quot;</span></span>));

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_relevant_cases_derived_from_data">Relevant Cases Derived From Data</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Attribute types or entity members that are non-primitive values (for example, an entity having a Date field or complex types).</p>
</li>
<li>
<p>Wildcards or special characters on queries.</p>
</li>
<li>
<p>Output entities, such as a list that contains different types of records.</p>
</li>
<li>
<p>If a client operation has not merely been wrapped, exercise connector custom code through a more complex test data setup for the test. An example of this are methods that receive a data representation object and return a concrete instance.
Hint: Check the developer’s unit tests.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><code>ConcreteInstance fromMap(Map&lt;String,Object&gt; mapRepresentation)</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_fields_with_unique_values">Fields with Unique Values</h3>
<div class="paragraph">
<p>Dynamically generate entity fields that contain unique values to make the automation runs more robust. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">randomEmailAddress</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.mule.modules.tests.ConnectorTestUtils</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">factory-method</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">generateRandomEmailAddress</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">scope</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">prototype</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_date_generation_common_cases">Date Generation Common Cases</h3>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">xmlGregorianCalendarDateInThePast</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.mule.modules.tests.ConnectorTestUtils</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">factory-method</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">generateXMLGregorianCalendarDateForYesterday</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">scope</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">prototype</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_user_related_data">User Related Data</h3>
<div class="paragraph">
<p>Use the automation-credentials.properties files in conjunction with AutomationSpringBeans.xml to test user related operations.</p>
</div>
<div class="sect3">
<h4 id="_automation_credentials_properties">automation-credentials.properties</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>taleo.username=username
taleo.password=password
taleo.companyCode=companyCode
taleo.userId=42</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_automationspringbeans">AutomationSpringBeans</h4>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.beans.factory.config.PropertyPlaceholderConfigurer</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">location</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;value&gt;</span>automation-credentials.properties<span class="tag">&lt;/value&gt;</span>
  <span class="tag">&lt;/property&gt;</span>
<span class="tag">&lt;/bean&gt;</span>

<span class="comment">&lt;!-- search-user  --&gt;</span>
<span class="tag">&lt;util:map</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">testSearchUserTestData</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">map-class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.util.HashMap</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">key-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.String</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.Object</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">scope</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">prototype</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">expectedUserId</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${taleo.userId}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
  <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">searchParams</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">searchUserSearchParams</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/util:map&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_methods">Test Methods</h2>
<div class="sectionbody">
<hr>
<div class="sect2">
<h3 id="_good_test_case_qualities">Good Test Case Qualities</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Flexibility: All data setup changes (for example, entity type changes) can be performed from the Spring file without modifying the tests.</p>
</li>
<li>
<p>Only runtime generated values should be handled in a test, everything else should be declared in the AutomationSpringBeans file.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DeleteRecord deleteUserRecordRequest = <span class="keyword">new</span> DeleteRecord();
deleteUserRecordRequest.setSysId(userSysId);
upsertPayloadContentOnTestRunMessage(deleteUserRecordRequest);
runFlowAndGetPayload(<span class="string"><span class="delimiter">&quot;</span><span class="content">delete-user-record</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Extensibility: Test cases can be used for any amount of entities and also apply validations to any kind of output.</p>
</li>
<li>
<p>@Test should not start with any kind of preparation prior to calling the operation under test. That should fall under the @Before method. Ideally a test should call the flow of the operation under test, assert the result, and, if applicable, set data required for the @After method.</p>
</li>
<li>
<p>Assertions are applied to values on the responses, avoid using the assertNotNull assertion.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In case a message processor returns an object that can contains null field values, it is acceptable to perform an assertNotNull on the field followed by the functional assertion on the field. This avoids failures being logged as errors.</p>
</li>
<li>
<p>If a message processor has void as its return type and the payload was not used to pass data to it you can use this assertion:</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">org.mule.modules.tests.ConnectorTestUtils.assertNullPayload(<span class="predefined-type">Object</span>)

GetResponse getResponse = runFlowAndGetPayload(<span class="string"><span class="delimiter">&quot;</span><span class="content">get-user</span><span class="delimiter">&quot;</span></span>);
assertEquals(userSysId, getResponse.getSysId());
assertEquals(expectedName, getResponse.getName());</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If void is returned by the operation under test, auxiliary calls to other operations can be made to verify that changes took effect.</p>
</li>
<li>
<p>As last resort, sets of void operations can be grouped by a test case that validates that no exception is returned by their usage.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_test_fixture_and_teardown">Test Fixture and tearDown</h3>
<div class="paragraph">
<p>Request test data and perform use case preparation logic on the @Before methods. A @Test method should contain if possible, only a single flow call (the one that relates to the operation under test) and the assertions on its payload. On the @After method, revert the changes to the sandbox.
The frameworks enforces:
. Data consumed by the operation under test must be taken from the TestRunMessage. This implies that the TestRunMessage is initialized at some point prior to the invocation of the flow containing the operation.
. Additional flows can be invoked without altering the TestRunMessage by using:
.. runFlowAndGetMessage(String flowName, String beanId)
.. runFlowAndGetPayload(String flowName, String beanId)
. Runtime values can be added to the TestRunMessage to prepare the data for the operation under test.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> <span class="annotation">@Before</span>
   <span class="directive">public</span> <span class="type">void</span> setUp() <span class="directive">throws</span> <span class="exception">Exception</span> {
      <span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt;
        leadRecord = getBeanFromContext(<span class="string"><span class="delimiter">&quot;</span><span class="content">listOperationMObject</span><span class="delimiter">&quot;</span></span>);
      initializeTestRunMessage(leadRecord);
      <span class="comment">// allows updating leadRecord with values from operation responses</span>
      ...
   }</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>"Operation under test" test data needs to be composed from setUp responses.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_errors_and_failures">Errors and Failures</h3>
<div class="paragraph">
<p>Fixture and tearDown throw Exception so that unexpected errors on their logic or calls are listed as an errors on the test and not as a failure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">   <span class="annotation">@Before</span>
   <span class="directive">public</span> <span class="type">void</span> setUp() <span class="directive">throws</span> <span class="exception">Exception</span> {
      <span class="comment">// setUp logic</span>
   }

   <span class="annotation">@Test</span>
   <span class="directive">public</span> <span class="type">void</span> setUp() <span class="directive">throws</span> <span class="exception">Exception</span> {
      <span class="comment">// setUp logic</span>
   }</code></pre>
</div>
</div>
<div class="paragraph">
<p>If an exception is thrown on the @Test, the test is listed as failed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">   <span class="annotation">@Category</span>({SmokeTests.class, RegressionTests.class})
   <span class="annotation">@Test</span>
   <span class="directive">public</span> <span class="type">void</span> test&lt;operationName&gt;() {
      <span class="keyword">try</span> {
         ...
      } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
         fail(ConnectorTestUtils.getStackTrace(e));
      }
   }</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_cases_classification">Test Cases Classification</h2>
<div class="sectionbody">
<hr>
<div class="paragraph">
<p>Tests are categorized using @Category annotation on top of the test method signatures.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Category</span>({SmokeTests.class, RegressionTests.class})
<span class="annotation">@Test</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Tests for operations that are used on the @Before or @After are to be marked as SmokeTests.</p>
</div>
<div class="sect2">
<h3 id="_test_runners_2">Test Runners</h3>
<div class="paragraph">
<p>One for each test case type (SmokeTest, RegressionTest). Placed on the org.mule.modules.&lt;connector&gt;.automation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RunWith</span>(Categories.class)
<span class="annotation">@IncludeCategory</span>(RegressionTests.class)

<span class="annotation">@SuiteClasses</span>({
      <span class="comment">// All &lt;operation&gt;TestCases classes within the automation.testcases package</span>
      AppendTestCases.class,
      DeleteDirectoryTestCases.class,
      ...
   })

<span class="directive">public</span> <span class="type">class</span> <span class="class">RegressionTestSuite</span> {

}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_datasense_dynamic_metadata">DataSense (Dynamic metadata)</h2>
<div class="sectionbody">
<hr>
<div class="paragraph">
<p>First of all create the DataSenseTestCases class on the connector functional test suite package</p>
</div>
<div class="sect2">
<h3 id="__metadatakeyretriever_method">@MetaDataKeyRetriever method</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add a testGetMetaDataKeys() method</p>
</li>
<li>
<p>In the AutomationSpringBeans create a map bean containing the data for the getMetadata() test methods method.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;util:map</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">getMetaDataKeysTestData</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">map-class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.util.HashMap</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">key-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.String</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">value-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.Object</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">scope</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">prototype</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">expectedMetaDataKeysCount</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">10</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">expectedMetaDataKeys</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;list</span> <span class="attribute-name">value-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.util.HashMap</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          <span class="tag">&lt;map</span> <span class="attribute-name">key-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.String</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.Object</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
              <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">displayName</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CI_POSITION_DATA#Find</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
              <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CI_POSITION_DATA#Find</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
              <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">category</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">InvokeCategory</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;/map&gt;</span>
          <span class="tag">&lt;map</span> <span class="attribute-name">key-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.String</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.Object</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
              <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">displayName</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CI_POSITION_DATA#Create</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
              <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CI_PERSONAL_DATA#Create</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
              <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">category</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">InvokeCategory</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
          <span class="tag">&lt;/map&gt;</span>
       <span class="tag">&lt;/list&gt;</span>
    <span class="tag">&lt;/entry&gt;</span>
<span class="tag">&lt;/util:map&gt;</span></code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To the DataSenseTestCases class add the following test cases</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Before</span>
<span class="directive">public</span> <span class="type">void</span> setUp() <span class="directive">throws</span> <span class="exception">Exception</span> {
    initializeTestRunMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">getMetaDataKeysTestData</span><span class="delimiter">&quot;</span></span>);
}

<span class="annotation">@Test</span>
<span class="annotation">@Category</span>({RegressionTests.class, SmokeTests.class})
<span class="directive">public</span> <span class="type">void</span> testGetMetaDataKeysSuccess() {
  assertGetMetaDataKeysSuccess(<span class="string"><span class="delimiter">&quot;</span><span class="content">PeopleSoft</span><span class="delimiter">&quot;</span></span>);
}

<span class="annotation">@Test</span>
<span class="annotation">@Category</span>({RegressionTests.class, SmokeTests.class})
<span class="directive">public</span> <span class="type">void</span> testGetMetaDataKeysAmount() {
  <span class="predefined-type">List</span>&lt;MetaDataKey&gt; retrievedMetadataKeys = getMetaDataKeyList(<span class="string"><span class="delimiter">&quot;</span><span class="content">PeopleSoft</span><span class="delimiter">&quot;</span></span>);
    assertEquals(retrievedMetadataKeys.size(), <span class="predefined-type">Integer</span>.parseInt((<span class="predefined-type">String</span>) getTestRunMessageValue(<span class="string"><span class="delimiter">&quot;</span><span class="content">expectedMetaDataKeysCount</span><span class="delimiter">&quot;</span></span>)));
}

<span class="annotation">@Test</span>
<span class="annotation">@Category</span>({RegressionTests.class, SmokeTests.class})
<span class="directive">public</span> <span class="type">void</span> testGetMetaDataKeysContainsKeys() {
    assertMetaDataKeysContainsKeys(<span class="string"><span class="delimiter">&quot;</span><span class="content">PeopleSoft</span><span class="delimiter">&quot;</span></span>, (<span class="predefined-type">List</span>&lt;<span class="predefined-type">HashMap</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt;&gt;) getTestRunMessageValue(<span class="string"><span class="delimiter">&quot;</span><span class="content">expectedMetaDataKeys</span><span class="delimiter">&quot;</span></span>));
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If additional testing wants to be performed mule-connector-case provides a set of methods for MetaData testing.
* assertGetMetaDataKeysSuccess
* getMetaDataKeyList
* assertMetaDataKeysContainsKeys</p>
</div>
</div>
<div class="sect2">
<h3 id="__metadataretriever_method">@MetaDataRetriever method</h3>
<div class="sect3">
<h4 id="_test_getmetadata_entity_retrieval_for_all_metadatakeys">Test getMetaData entity retrieval for all MetaDataKeys</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add a Timeout rule on the DataSenseTestCases class to avoid the testGetMetaData from not completing its execution</p>
</li>
<li>
<p>Add a testGetMetadata() method to the DataSenseTestCases class</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Rule</span>
<span class="directive">public</span> Timeout globalTimeout = <span class="keyword">new</span> Timeout(<span class="integer">360000</span>);

<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testGetMetaData() {
  <span class="predefined-type">List</span>&lt;MetaDataKey&gt; metaDataKeys = getMetaDataKeyList(<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce</span><span class="delimiter">&quot;</span></span>);
  <span class="predefined-type">Iterator</span>&lt;MetaDataKey&gt; iterator = metaDataKeys.iterator();

  <span class="keyword">while</span> (iterator.hasNext()) {
    MetaDataKey metaDataKey = iterator.next();
    <span class="predefined-type">Result</span>&lt;MetaData&gt; metaData = connector.getMetaData(metaDataKey);
    assertTrue(<span class="predefined-type">Result</span>.Status.SUCCESS.equals(metaData.getStatus()));
  }

}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_test_getmetadata_method_logic_for_a_given_entity">Test getMetaData method logic for a given entity</h4>
<div class="paragraph">
<p>Add a GetMetaDataTestCases test class for all test related to input and output MetaData for target processors and entities.</p>
</div>
<div class="paragraph">
<p>To check the MetaData model implemented on the connector select an entity that exercises it.</p>
</div>
<div class="paragraph">
<p>First you&#8217;ll need to define the method/entity under test and add it to your automation-test-flows.xml file</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">get-metadata-find</span><span class="delimiter">&quot;</span></span> <span class="tag">&gt;</span>
    <span class="tag">&lt;peoplesoft:invoke-operation</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CI_POSITION_DATA#Find</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PeopleSoft</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PeopleSoft</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;peoplesoft:params</span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/peoplesoft:invoke-operation&gt;</span>
<span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Using getOutputMetaDataPayload retrieve the MetaDataModel and cast it in order to check how the entities are described</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="annotation">@Test</span>
    <span class="annotation">@Category</span>({RegressionTests.class, SmokeTests.class})
    <span class="directive">public</span> <span class="type">void</span> testGetMetaDataCI_POSITION_DATAType() {
        <span class="keyword">try</span> {
            MetaDataModel payload = getOutputMetaDataPayload(<span class="string"><span class="delimiter">&quot;</span><span class="content">get-metadata-find</span><span class="delimiter">&quot;</span></span>);
            DefinedMapMetaDataModel definedMapMetaDataModel = (DefinedMapMetaDataModel) ((ListMetaDataModel) payload).getElementModel();
            <span class="predefined-type">List</span>&lt;MetaDataField&gt; fields = definedMapMetaDataModel.getFields();
            assertEquals(<span class="integer">7</span>, fields.size());
        } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
            fail(ConnectorTestUtils.getStackTrace(e));
        }
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_grouping_types">Grouping Types</h3>
<div class="paragraph">
<p>For the testGetMetaDataKeysContainsKeys() test select entities that would have different category fields values because of their @MetaDataCategory class origin.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;list</span> <span class="attribute-name">value-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.util.HashMap</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;map</span> <span class="attribute-name">key-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.String</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.Object</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">displayName</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Account</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">AccountId</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">category</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CategoryA</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/map&gt;</span>
  <span class="tag">&lt;map</span> <span class="attribute-name">key-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.String</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value-type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.Object</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">displayName</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Account</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">AccountId</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;entry</span> <span class="attribute-name">key</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">category</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CategoryB</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;/map&gt;</span>
<span class="tag">&lt;/list&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Besides take one processor as representative of each @MetaDataCategory class (check their @MetaDataScope attribute value for that) and test their MetaData input and output behaviour by selecting the most representative entity.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="annotation">@Processor</span>
    <span class="annotation">@MetaDataScope</span>(InvokeCategory.class)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt;&gt; invokeOperation(<span class="annotation">@MetaDataKeyParam</span> <span class="predefined-type">String</span> type, <span class="annotation">@Default</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">#[payload]</span><span class="delimiter">&quot;</span></span>) <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt; params) {</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">get-meta-data-get</span><span class="delimiter">&quot;</span></span> <span class="tag">&gt;</span>
    <span class="tag">&lt;peoplesoft:invoke-operation</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">CI_POSITION_DATA#Get</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PeopleSoft</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">PeopleSoft</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;peoplesoft:params</span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/peoplesoft:invoke-operation&gt;</span>
<span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="annotation">@Category</span>({RegressionTests.class, SmokeTests.class})
<span class="directive">public</span> <span class="type">void</span> testGetProcessorIsMetaDataEnabled() {
  assertIsMetaDataEnabled(<span class="string"><span class="delimiter">&quot;</span><span class="content">get-meta-data-get</span><span class="delimiter">&quot;</span></span>);
}

<span class="annotation">@Test</span>
<span class="annotation">@Category</span>({RegressionTests.class, SmokeTests.class})
<span class="directive">public</span> <span class="type">void</span> testGetMetaDataGetInputMetaData() {
  <span class="keyword">try</span> {
    assertFirstLevelInputMetaDataSuccess(<span class="string"><span class="delimiter">&quot;</span><span class="content">get-meta-data-get</span><span class="delimiter">&quot;</span></span>, DataType.MAP);
  } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
    fail(ConnectorTestUtils.getStackTrace(e));
  }
}

<span class="annotation">@Test</span>
<span class="annotation">@Category</span>({RegressionTests.class, SmokeTests.class})
<span class="directive">public</span> <span class="type">void</span> testGetMetaDataGetOutputMetaData() {
  <span class="keyword">try</span> {
    assertListFirstLevelOutputMetaDataSuccess(<span class="string"><span class="delimiter">&quot;</span><span class="content">get-meta-data-get</span><span class="delimiter">&quot;</span></span>, DataType.MAP.toString());
  } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
    fail(ConnectorTestUtils.getStackTrace(e));
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_metadataoutputretriever">MetaDataOutputRetriever</h3>
<div class="paragraph">
<p>In case that an @MetaDataOutputRetriever method is implemented test cases for it should be written with assertions on the input and output MetaData of the operations affected by its logic.</p>
</div>
</div>
<div class="sect2">
<h3 id="_input_metadata_negative_cases">Input MetaData Negative cases</h3>
<div class="paragraph">
<p>Logic added to handle requests to retrieve input MetaData passing an invalid type should be covered also on the GetMetaDataTestCases class.
Follow the approach of adding specific flows containing processors with an invalid type and requesting its input MetaData</p>
</div>
<div class="paragraph">
<p>Error message should relate to the connector domain.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_connection">Test Connection</h2>
<div class="sectionbody">
<hr>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add the necessary config elements to support test configuration negative cases to the automation-test-flows.xml file. Config elements name convention is as follows: Test_Connection_Negative_&lt;Particular_Case&gt;. See an example below.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;mongo:config</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Mongo_DB</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">username</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${mongo.username}</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${mongo.password}</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${mongo.host}</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${mongo.port}</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">database</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${mongo.database}</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Mongo DB</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">connectionsPerHost</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">4</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">maxWaitTime</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5000</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;mongo:connection-pooling-profile</span>
        <span class="attribute-name">maxActive</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">initialisationPolicy</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INITIALISE_ONE</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">exhaustedAction</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WHEN_EXHAUSTED_WAIT</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">maxWait</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5000</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/mongo:config&gt;</span>

<span class="tag">&lt;mongo:config</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Test_Connection_Negative_Invalid_Username</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">username</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INVALID_USERNAME</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">password</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${mongo.password}</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${mongo.host}</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${mongo.port}</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">database</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${mongo.database}</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Mongo DB</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">connectionsPerHost</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">4</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">maxWaitTime</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5000</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;mongo:connection-pooling-profile</span>
        <span class="attribute-name">maxActive</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">initialisationPolicy</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INITIALISE_ONE</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">exhaustedAction</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">WHEN_EXHAUSTED_WAIT</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">maxWait</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5000</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/mongo:config&gt;</span>

 ...</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the ConnectTestCases class</p>
</li>
<li>
<p>Add a positive and any necessary negative tests</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">import</span> <span class="include">org.mule.common.Result</span>;
<span class="keyword">import</span> <span class="include">org.mule.common.TestResult</span>;
<span class="keyword">import</span> <span class="include">org.mule.common.Testable</span>;

<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testConnectInvalidUsername() <span class="directive">throws</span> <span class="exception">Exception</span> {
    TestResult testResult =  getGlobalElementTestable(<span class="string"><span class="delimiter">&quot;</span><span class="content">Test_Connection_Negative_Invalid_Username</span><span class="delimiter">&quot;</span></span>).test();
    assertEquals(<span class="predefined-type">Result</span>.Status.FAILURE, testResult.getStatus());
    assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">INVALID_CREDENTIALS</span><span class="delimiter">&quot;</span></span>, testResult.getFailureType().getName());
    assertEquals(<span class="string"><span class="delimiter">&quot;</span><span class="content">Couldn't connect with the given credentials</span><span class="delimiter">&quot;</span></span>, testResult.getMessage());
}

<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testConnectSuccess() <span class="directive">throws</span> <span class="exception">Exception</span> {
    TestResult testResult =  ((Testable) getGlobalElementTestable(<span class="string"><span class="delimiter">&quot;</span><span class="content">Mongo_DB</span><span class="delimiter">&quot;</span></span>)).test();
    assertEquals(<span class="predefined-type">Result</span>.Status.SUCCESS, testResult.getStatus());
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_transformers">Transformers</h2>
<div class="sectionbody">
<hr>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>For each transformer add a flow to the automation-test-flows.xml.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">db-object-to-json-transformer</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;mongo:dbobject-to-json</span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Mongo DB</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a TransformersTestCases class</p>
</li>
<li>
<p>Call an operation that would return an object of the &lt;typeFrom&gt; type</p>
</li>
<li>
<p>Insert that type on the payload</p>
</li>
<li>
<p>Call the flow containing the transformer</p>
</li>
<li>
<p>Cast or parse the returned to the &lt;typeTo&gt; class.</p>
</li>
<li>
<p>No exceptions should be risen when tests are run.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> testDbObjectToJSONTransformer() {

  GridFSInputFile operationPayload = <span class="predefined-constant">null</span>;

  <span class="keyword">try</span> {

    <span class="predefined-type">File</span> file = folder.newFile(getTestRunMessageValue(<span class="string"><span class="delimiter">&quot;</span><span class="content">filename</span><span class="delimiter">&quot;</span></span>).toString());

    upsertOnTestRunMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">filename</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">filename</span><span class="delimiter">&quot;</span></span>);
    upsertOnTestRunMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">metadataRef</span><span class="delimiter">&quot;</span></span>, <span class="keyword">new</span> BasicDBObject());
    upsertOnTestRunMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">payloadContent</span><span class="delimiter">&quot;</span></span>, file);

    operationPayload = runFlowAndGetPayload(<span class="string"><span class="delimiter">&quot;</span><span class="content">create-file-from-payload</span><span class="delimiter">&quot;</span></span>);

    upsertOnTestRunMessage(<span class="string"><span class="delimiter">&quot;</span><span class="content">payloadContent</span><span class="delimiter">&quot;</span></span>, operationPayload);

    <span class="predefined-type">Object</span> json = JSON.parse((<span class="predefined-type">String</span>) runFlowAndGetPayload(<span class="string"><span class="delimiter">&quot;</span><span class="content">db-object-to-json-transformer</span><span class="delimiter">&quot;</span></span>));

  } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
    fail(ConnectorTestUtils.getStackTrace(e));
  }

}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_inbound_endpoints_sources">Testing Inbound Endpoints (@Sources)</h2>
<div class="sectionbody">
<hr>
<div class="paragraph">
<p>For now, inbound endpoint testing must be done by adding a <a href="http://www.mulesoft.org/documentation/display/current/VM+Transport+Reference">VM endpoint</a> in the flow that has the inbound endpoint we want to test. A VM endpoint is essentially an in-memory queue (hence the name VM, because they are handled by the JVM) addressable by a URL that stores messages until they are processed. By storing the messages received by the inbound endpoint in a VM queue, we can retrieve them in the test case and make assertions on them.</p>
</div>
<div class="paragraph">
<p>For example, if we want to test SQS’s Receive Messages operation, we need two flows: a flow that actually sends the message, and another flow with the Receive Messages inbound endpoint, as such:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">send-message</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SendMessage</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
           <span class="tag">&lt;sqs:send-message</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Sqs</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">message</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[flowVars.message]</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">queueUrl</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[flowVars.queueUrl]</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/flow&gt;</span>

<span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">receive-message</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">receive-message</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;sqs:receive-messages</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Sqs</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">queueUrl</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[flowVars.queueUrl]</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        ...
<span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To actually get the messages to use in our test, we need to add a VM endpoint to the flow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">receive-message</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">receive-message</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;sqs:receive-messages</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Sqs</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">queueUrl</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[flowVars.queueUrl]</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;vm:outbound-endpoint</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">receive</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To use the VM endpoint, add this Maven dependency to your project&#8217;s pom.xml file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
<span class="tag">&lt;groupId&gt;</span>org.mule.transports<span class="tag">&lt;/groupId&gt;</span>
<span class="tag">&lt;artifactId&gt;</span>mule-transport-vm<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>${mule.version}<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Update your XML schemas and namespaces as described in the <a href="http://www.mulesoft.org/documentation/display/current/VM+Transport+Reference">VM endpoint documentation</a>.</p>
</div>
<div class="paragraph">
<p>Use (for now) the runFlowAndWaitForResponseVM method. The important thing to note here is the path of the queue. A simple test for these flows is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> testReceiveMessages() <span class="directive">throws</span> <span class="exception">Exception</span> {
    <span class="predefined-type">String</span> message = <span class="error">“</span>Hello world<span class="error">”</span>;
    upsertOnTestRunMessage(<span class="error">“</span>message<span class="error">”</span>, message);
    <span class="predefined-type">String</span> response = runFlowAndWaitForResponseVM(<span class="error">“</span>send-message<span class="error">”</span>, <span class="error">“</span>receive<span class="error">”</span>, <span class="integer">500L</span>);
    assertEquals(message, response);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The parameters for runFlowAndWaitForResponseVM are as follows:
. The flow to run.
. The VM queue to wait for messages on.
. How long to wait (in milliseconds) before timing out and throwing an exception.</p>
</div>
<div class="paragraph">
<p>This information can also be seen in the JavaDoc for this method.</p>
</div>
<div class="paragraph">
<p>This is a preliminary way to implement this functionality because ideally there should be no need to manually add endpoints to flows in order to test them. See <a href="https://www.google.com/url?q=https%3A%2F%2Fwww.mulesoft.org%2Fjira%2Fbrowse%2FCLDCONNECT-1472&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNEsSvDUicqmL7DHFD5Ch01mWqa4zg">CLDCONNECT-1472</a> for more information.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setting_up_oauth_authentication">Setting Up OAuth Authentication</h2>
<div class="sectionbody">
<hr>
<div class="paragraph">
<p>Manually generate the accessToken and pass this along with the credentials to the service to run the test suite.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s use Facebook as example:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Manually get the Access Token <a href="https://developers.facebook.com/tools/explorer">Graph API Explorer</a>.</p>
</li>
<li>
<p>Add accessToken property to the automation-credentials.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>facebook.username=&lt;usernameValue&gt;
facebook.appId=&lt;appIdValue&gt;
facebook.appSecret=&lt;appSecretValue&gt;
facebook.domain=&lt;domainValue&gt;
facebook.localPort=&lt;localPortValue&gt;
facebook.remotePort=&lt;remotePortValue&gt;
facebook.path=&lt;pathValue&gt;
facebook.accessToken=&lt;generatedAccessToken&gt;</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add FacebookConnectorOAuthState bean to AutomationSpringBeans.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;bean</span>
  <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.springframework.beans.factory.config.PropertyPlaceholderConfigurer</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
 <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">location</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
   <span class="tag">&lt;value&gt;</span>automation-credentials.properties<span class="tag">&lt;/value&gt;</span>
 <span class="tag">&lt;/property&gt;</span>
<span class="tag">&lt;/bean&gt;</span>
<span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">connectorOAuthState</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">org.mule.module.facebook.oauth.FacebookConnectorOAuthState</span><span class="delimiter">&quot;</span></span> <span class="tag">&gt;</span>
  <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">accessToken</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${facebook.accessToken}</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In &lt;connectorName&gt;TestParent, after initializing the muleContext, add a FacebookConnectorOAuthState instance to the Object Store.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Before</span>
    <span class="directive">public</span> <span class="type">void</span> init() <span class="directive">throws</span> ObjectStoreException {
    ObjectStore objectStore = muleContext.getRegistry().lookupObject(MuleProperties.DEFAULT_USER_OBJECT_STORE_NAME);
    objectStore.store(<span class="string"><span class="delimiter">&quot;</span><span class="content">accessTokenId</span><span class="delimiter">&quot;</span></span>, (FacebookConnectorOAuthState) context.getBean(<span class="string"><span class="delimiter">&quot;</span><span class="content">connectorOAuthState</span><span class="delimiter">&quot;</span></span>));
  }</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add accessTokenId="accessTokenId" to the operations on automation-test-flows. The ObjectStore resolves this value.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;facebook:config-with-oauth</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Facebook</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">appId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${facebook.appId}</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">appSecret</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${facebook.appSecret}</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Facebook</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
<span class="tag">&lt;facebook:oauth-callback-config</span> <span class="attribute-name">domain</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${facebook.domain}</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">localPort</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${facebook.localPort}</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">remotePort</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${facebook.remotePort}</span><span class="delimiter">&quot;</span></span>
  <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${facebook.path}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/facebook:config-with-oauth&gt;</span>

<span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">get-user</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">get-user</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;facebook:get-user</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Facebook</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">user</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[flowVars.username]</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">accessTokenId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">accessTokenId</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Facebook</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
<span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_running_the_suites">Running the Suites</h3>
<div class="paragraph">
<p>From the console:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>export SALESFORCE_CREDENTIALS=http://172.16.20.35/automation/salesforce/automation-credentials.mvnproperties
mvn -Dtest=SmokeTestSuite test
mvn -Dtest=GetDailyTrendsTestCases#testGetDailyTrendsParametrized test</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>mvn -Dtest=SmokeTestSuite -Dmule.test.timeoutSecs=180 -DSALESFORCE_CREDENTIALS=http://172.16.20.35/automation/salesforce/automation-credentials.properties test</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix_2">Appendix</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://github.com/mulesoft/connector-certification-docs/blob/docs/current/attachments/automated%20funcional%20testing/appendixA.adoc">Appendix A: Debugging</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_studio_functional_test_plugin">Studio Functional Test Plugin</h2>
<div class="sectionbody">
<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The framework described in this document consists of a series of automation tools, which let you run interoperability tests on a connector in Anypoint Studio. The framework covers Connectivity, Datamapper Compliance, and XML Generation tests, as described in the Connectors QA Guidelines. The data used by these tests is generated using not only a connector&#8217;s code, but also the output files in the DevKit, in particular the schema and editors file.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_anypoint_studio_plugin">Anypoint Studio Plugin</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_glossary_of_terms">Glossary of Terms</h3>
<div class="paragraph">
<p>Runner Platform: Host where the test run takes place.
Target Platform: The platform (in terms of Anypoint Studio plugins) on which tests are going to that you run.
CUT: Connector under test
*-test-data.xml
*-test-data-override.xml</p>
</div>
</div>
<div class="sect2">
<h3 id="_installation">Installation</h3>
<div class="sect3">
<h4 id="_step_1_check_system_requirements">Step 1: Check System Requirements</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="http://maven.apache.org/download.cgi">Maven 3.2</a> or Greater</p>
</li>
<li>
<p><a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html">Java 1.7</a></p>
</li>
<li>
<p><a href="http://www.mulesoft.org/download-mule-esb-community-edition">Anypoint Studio</a></p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_step_2_anypoint_devkit_plugin">Step 2: Anypoint Devkit Plugin</h4>
<div class="paragraph">
<p>Follow these steps on the Runner Platform&#8217;s Anypoint Studio installation:
. Click Help &gt; Install New Software.
. Click Anypoint Addons Update Site from the Work with drop-down. Note: If this item is not in the dropdown, click Add and specify the name, and for the URL, use: <a href="http://studio.mulesoft.org/r3/addons/beta" class="bare">http://studio.mulesoft.org/r3/addons/beta</a>
. Click the checkbox for Anypoint DevKit Plugin, and click <strong>Next, Next, Finish</strong>.
. Restart Anypoint Studio when prompted.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_generating_functional_tests">Generating Functional Tests</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_plugin_execution">Plugin Execution</h3>
<div class="paragraph">
<p>With your connector imported in Anypoint Studio, right-click the project name in Package Explorer and click <strong>Anypoint Connector &gt; Generate Tests</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/functional-test-plugin-1.png" alt="functional test plugin 1">
</div>
</div>
<div class="paragraph">
<p>The Test Scaffolding Generation dialog appears:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/functional-test-plugin-2.png" alt="functional test plugin 2">
</div>
</div>
<div class="paragraph">
<p>This lists:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Processors found in the connector.</p>
</li>
<li>
<p>The Generate Test Case Scaffolding option: This generates the TestCases.java classes, one for each processor, along with the classes you need to use the Functional Test Framework.</p>
</li>
<li>
<p>The Generate Functional Test Data Files option: This generates the automation-test-flow.xml and AutomationSpringBeans.xml files.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If a conflict exists between the existing files and the files you want to generate, a popup appears asking if the file should be replaced, or updated with the information related to new processors. This does not cover cases of signature change in the processor definition, nor updating naming convention on existing Java classes.</p>
</div>
<div class="paragraph">
<p>Generated Files</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/functional-test-plugin-3.png" alt="functional test plugin 3">
</div>
</div>
<div class="paragraph">
<p>Output files can be found under src/test/resources/generated. The actual convention is to have the files under src/test/resources, and the generated path is only expected to store files during development or those with constant modification.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_studio_interoperability_test_plugin">Studio Interoperability Test Plugin</h2>
<div class="sectionbody">
<div class="sect1">
<h2 id="_introduction_2">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following framework consists of a series of automation tools, which allow you to run interoperability tests on a connector in Anypoint Studio. The data used by these tests  generates using not only the connectors code, but also DevKit output files, in particular the schema and editors file.</p>
</div>
<div class="paragraph">
<p>All cases described in the <a href="https://docs.google.com/a/mulesoft.com/document/d/1HIiE8akbyr-jdfS-XJUZo45JL0J6G2OmQY_jO4rEkz4">Interoperability Test Guidelines</a> should be considered depending on the connector’s nature. This means, all the applicable test cases detailed there must be covered for a full interoperability test of the connector.</p>
</div>
<div class="paragraph">
<p><strong>Note</strong>: The Anypoint Studio plugin covers only the following cases:
 * Connectivity testing
 * Datamapper compliance
 * Xml generation</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_glossary">Glossary</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Runner platform: Host where the test run will take place.</p>
</li>
<li>
<p>Target platform: Describes the platform (in terms of Studio plugins) on which tests are going to we run.</p>
</li>
<li>
<p>CUT: Connector under test</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>*-test-data.xml<br></p>
</li>
<li>
<p>*-test-data-override.xml</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation_2">Installation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_step_1_check_system_requirements_2">Step 1: Check System Requirements</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html">JDK 7</a></p>
</li>
<li>
<p><a href="http://maven.apache.org/download.cgi">Apache Maven</a></p>
</li>
<li>
<p><a href="http://www.mulesoft.org/download-mule-esb-community-edition">Anypoint Studio</a></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_anypoint_devkit_plugin_2">Step 2: Anypoint Devkit Plugin</h3>
<div class="paragraph">
<p>Follow these steps on the Runner Platform&#8217;s Anypoint Studio installation:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <strong>Help</strong> &gt; <strong>Install New Software</strong>.</p>
</li>
<li>
<p>Click <strong>Anypoint Addons Update Site</strong> from the <strong>Work with</strong> drop-down. <strong>Note</strong>: If this item is not in the dropdown, click <strong>Add</strong> and specify the name, and for the URL, use: <a href="http://studio.mulesoft.org/r3/addons/beta" class="bare">http://studio.mulesoft.org/r3/addons/beta</a></p>
</li>
<li>
<p>Click the checkbox for <strong>Anypoint DevKit Plugin</strong>, and click <strong>Next, Next</strong>, <strong>Finish</strong>.</p>
</li>
<li>
<p>Restart Anypoint Studio when prompted.</p>
</li>
<li>
<p>Confirm you have Maven installed:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open the Anypoint Studio preferences (on a Mac, click <strong>Anypoint Studio</strong> &gt; <strong>Preferences</strong>, on a Windows computer, click <strong>Window</strong> &gt; <strong>Preferences</strong>).</p>
</li>
<li>
<p>Navigate to <strong>Anypoint Studio</strong> &gt; <strong>Maven Settings</strong> and ensure that the Maven installation home directory points to the directory where you installed Maven.</p>
</li>
<li>
<p>Click <strong>Test Maven Configuration</strong> to ensure that Maven is correctly configured.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interop_test_run_tutorial">Interop Test Run Tutorial</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_step_1_anypoint_connector_project_in_workspace">Step 1: Anypoint Connector Project in Workspace</h3>
<div class="paragraph">
<p>If you have an existing connector project, import it into Anypoint Studio with this command: <code>mvn eclipse:eclipse</code><br>
Import the project as <strong>Anypoint Connector Project from External Location</strong></p>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_generating_test_data_files">Step 2: Generating Test Data Files</h3>
<div class="paragraph">
<p>If you are not familiar with testData files used for interop testing, refer to Appendix B.<br>
Right-click the name of your connector in the Package Explorer and click <br>
<strong>Anypoint Connector &gt; Generate Tests</strong>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/test-plugin-1.png" alt="test plugin 1">
</div>
</div>
<div class="paragraph">
<p>The <strong>Tests Scaffolding Generation</strong> dialog lets you select the operations in scope and the different files type of tests, functional or interoperability, that the required test data files generate:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/test-plugin-2.png" alt="test plugin 2">
</div>
</div>
<div class="paragraph">
<p>Interop Test Data Generation setup:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click the <strong>Select All</strong> button. The generation considers all available message processors of the connector.</p>
</li>
<li>
<p>Under Studio Interop Tests, check <strong>Generate Interop Test Data Files</strong></p>
</li>
<li>
<p>Leave the default test data filename <strong>interop-testdata.xml</strong> or define one of your own. The default behavior in case of finding matching filenames on the output folder is to update them.</p>
</li>
<li>
<p>Credentials File expected input is the path to a .properties file, which is used to determine which Configuration Element fields are required for authentication. The effects of this can be seen on the &lt;connectorName&gt;-testData-override.xml file. For example .properties contains:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>salesforce.username=salesforce.username.value +
salesforce.password=salesforce.password.value +
salesforce.securityToken=salesforce.securityToken.value +
salesforce.url=salesforce.url.value</pre>
</div>
</div>
<div class="paragraph">
<p>This generates a config element on the &lt;connectorName&gt;-testData-override.xml file such as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;config</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">config</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;attributes&gt;</span>
    <span class="tag">&lt;attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">caption</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Username</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">group</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Connection</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">javaType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.String</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">prefix</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">salesforce</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>salesforce.username.value<span class="tag">&lt;/attribute&gt;</span>
    <span class="tag">&lt;attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">caption</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Password</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">group</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Connection</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">javaType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.String</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">prefix</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">salesforce</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>salesforce.password.value<span class="tag">&lt;/attribute&gt;</span>
    <span class="tag">&lt;attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">securityToken</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">caption</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Security Token</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">group</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Connection</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">javaType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.String</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">prefix</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">salesforce</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>salesforce.securityToken.value<span class="tag">&lt;/attribute&gt;</span>
    <span class="tag">&lt;attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">url</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">caption</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Url</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">group</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Connection</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">string</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">javaType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.String</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">default</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://login.salesforce.com/services/Soap/u/31.0</span><span class="delimiter">&quot;</span></span>
      <span class="attribute-name">prefix</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">salesforce</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>salesforce.url.value<span class="tag">&lt;/attribute&gt;</span>
  <span class="tag">&lt;/attributes&gt;</span>
<span class="tag">&lt;/config&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of this command should be the following files (see Files section for details): <br>
_- nameOfOutputFile.xml _<br>
Basic data retrieved from the connector. Provides a complete view of every processor and all its attributes.</p>
</div>
<div class="paragraph">
<p><em>- nameOfOutputFile-override.xml</em><br>
Presents a subset of the data found in the previous file, with only the required fields, but adds information about the connector and processor features and properties</p>
</div>
<div class="paragraph">
<p>For this tutorial, &lt;testDataFilename&gt;.xml and &lt;testDataFilename&gt;-override.xml files are the result of the Tests Scaffolding Generation process for Studio Interop Tests. Generated files are placed on src/test/resources/generated.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_customizing_test_data_files">Step 3: Customizing Test Data Files</h3>
<div class="paragraph">
<p>After the testData and testData-override files are created (details about this files in Appendix), the next step is to populate the content from your domain model. This implies the completion of valid inputs for the operations and configurations, and the validation of the retrieved data.</p>
</div>
<div class="sect3">
<h4 id="_attention_points">Attention Points</h4>
<div class="ulist">
<ul>
<li>
<p>Properties detected must be checked and asserted:</p>
<div class="ulist">
<ul>
<li>
<p>The fact that the connector has connectivity support must be validated. If your connector does not support connectivity, but it was detected as a supported feature, you’ll have to double check your code.</p>
</li>
<li>
<p>If the connector has OAuth support, then connectivity detection must be false.</p>
</li>
<li>
<p>If the connector has OAuth support, then metadata detection should not be dynamic.</p>
</li>
<li>
<p>For each processor, <em>query-support</em> and <em>auto-paging</em> properties should be coherent with the expected values.</p>
</li>
<li>
<p>Required fields, both in the config and in the processors should be coherent with the expected values declared in the processor declaration. Those annotated with @Optional should be <em>optional</em>, everything else should be <em>required</em>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Datamapper input/output fields:</p>
<div class="ulist">
<ul>
<li>
<p>Datamapper Input and Output attributes in each processor represent the values you expect to see at design time when you drop the connector before and after a datamapper element. This values should be empty only if you expect to see nothing in DataMapper.</p>
</li>
<li>
<p>In a dynamic metadata case, the value of input/output attributes will be bound to the value with which the operation is feeded.
For example, with dynamic metadata, if you have:</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;properties&gt;</span>
        <span class="tag">&lt;datamapper</span> <span class="attribute-name">input</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">List</span><span class="entity">&amp;lt;</span><span class="content">SaveResult</span><span class="entity">&amp;gt;</span><span class="delimiter">&quot;</span></span><span class="attribute-name">output</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">List</span><span class="entity">&amp;lt;</span><span class="content">Map</span><span class="entity">&amp;gt;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/properties&gt;</span>
<span class="tag">&lt;attributes&gt;</span>
        <span class="tag">&lt;attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">caption</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sObject Type</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">group</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Information</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">type-chooser</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">javaType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.String</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;/attribute&gt;</span>
<span class="tag">&lt;/attributes&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The output value is bounded to the value declared in the type chooser as follows:</p>
</div>
<div class="paragraph">
<p><strong>Case Account</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;properties&gt;</span>
        <span class="tag">&lt;datamapper</span> <span class="attribute-name">input</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">List</span><span class="entity">&amp;lt;</span><span class="content">SaveResult</span><span class="entity">&amp;gt;</span><span class="delimiter">&quot;</span></span><span class="attribute-name">output</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">List</span><span class="entity">&amp;lt;</span><span class="content">Account</span><span class="entity">&amp;gt;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/properties&gt;</span>
<span class="tag">&lt;attributes&gt;</span>
        <span class="tag">&lt;attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">caption</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sObject Type</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">group</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Information</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">type-chooser</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">javaType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.String</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span> Account (Account)
        <span class="tag">&lt;/attribute&gt;</span>
<span class="tag">&lt;/attributes&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Case Contact</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;properties&gt;</span>
        <span class="tag">&lt;datamapper</span> <span class="attribute-name">input</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">List</span><span class="entity">&amp;lt;</span><span class="content">SaveResult</span><span class="entity">&amp;gt;</span><span class="delimiter">&quot;</span></span><span class="attribute-name">output</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">List</span><span class="entity">&amp;lt;</span><span class="content">Contact</span><span class="entity">&amp;gt;</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/properties&gt;</span>
<span class="tag">&lt;attributes&gt;</span>
        <span class="tag">&lt;attribute</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">use</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">required</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">caption</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">sObject Type</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">group</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Information</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">type-chooser</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">javaType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">java.lang.String</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span> Contact (Contact)
        <span class="tag">&lt;/attribute&gt;</span>
<span class="tag">&lt;/attributes&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>If metadata model is static, then the expected value should be the initial one, with <em>“List&lt;Map&gt;”</em> as the output value.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_run_interop_tests">Step 4: Run Interop Tests</h3>
<div class="paragraph">
<p>In Studio, right-click the project and click <strong>Anypoint Connector *&gt;</strong> Run Interop Tests*:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/test-plugin-3.png" alt="test plugin 3">
</div>
</div>
<div class="paragraph">
<p>The Interop Remote Runner Properties menu shows the existing testData files that were created previously, and a set of options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Tests to run:  Select which kind of test to run on your connector.</p>
<div class="ulist">
<ul>
<li>
<p>Connectivity</p>
</li>
<li>
<p>Data Mapper</p>
</li>
<li>
<p>Xml Generation</p>
</li>
</ul>
</div>
</li>
<li>
<p>Verbose Mode</p>
<div class="ulist">
<ul>
<li>
<p>Enables debugging logs on the test runs</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/test-plugin-4.png" alt="test plugin 4">
</div>
</div>
<div class="paragraph">
<p>The results appear in target/surefire-reports, and provide jUnit results using the XML result file.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendix_3">Appendix</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://github.com/mulesoft/connector-certification-docs/blob/docs/current/attachments/studio%20test%20plugin/appendixA.adoc">Appendix A: Usage without Studio</a></p>
</li>
<li>
<p><a href="https://github.com/mulesoft/connector-certification-docs/blob/docs/current/attachments/studio%20test%20plugin/appendixB.adoc">Appendix B: Plugin Result Files</a></p>
</li>
<li>
<p><a href="https://github.com/mulesoft/connector-certification-docs/blob/docs/current/attachments/studio%20test%20plugin/projectDetails.adoc">Project Details</a></p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_static_code_analysis_with_sonarqube">Static Code Analysis with SonarQube</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Most automatic validations on your connector’s code are done with SonarQube, an open source static code analysis tool that helps developers identify hot spots in code, bad code quality, technical debt, as well as define a number of other issues. To release a connector, you must fix blocker and critical issues.</p>
</div>
<div class="paragraph">
<p>To perform these validations yourself, install and configure a the SonarQube server that we provide with rules specific to the certification process. If you are certifying multiple connectors, you can reuse the same server.</p>
</div>
<div class="paragraph">
<p>Note: For guidelines on how to build your tests using this framework, see <a href="http://mulesoft.github.io/connector-certification-docs/current/user-manual.html#_automated_functional_testing">Automated Functional Testing</a>.</p>
</div>
<div class="sect1">
<h2 id="_installing_sonarqube">Installing SonarQube</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The quickest way to get SonarQube up and running is to install it locally with an embedded database. If you wish to use a standalone database or a more advanced configuration, see the related SonarQube Eclipse Plugin Setup documentation.</p>
</div>
<div class="paragraph">
<p>You need a server running Oracle JRE 6 or higher. (OpenJRE or other distributions are not supported by SonarQube.)</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download and extract <a href="https://drive.google.com/open?id=0B8N265C555thQWNPYkQ4cnFBQlU&amp;authuser=0">our SonarQube 4.5 distribution</a> (all platforms). This includes our custom quality profile and everything you need to get started.</p>
</li>
<li>
<p>Run <em>&lt;installDir&gt;/bin/&lt;yourOS&gt;/sonar.sh</em> start or <em>&lt;installDir&gt;\bin\&lt;yourOS&gt;\StartSonar.bat</em> if on Windows. The server might take a while to start even after the “Started SonarQube” message appears.</p>
</li>
<li>
<p>Browse to <a href="http://localhost:9000" class="bare">http://localhost:9000</a>.</p>
</li>
<li>
<p>Log in with the following credentials:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Username: admin</p>
</li>
<li>
<p>Password: admin</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_performing_your_first_analysis">Performing Your First Analysis</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For the first run of your project, go to the project’s root folder and run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn clean org.jacoco:jacoco-maven-plugin:prepare-agent test -Dmaven.test.failure.ignore=true
	-Dtest=RegressionTestSuite -D&lt;connector&gt;_CREDENTIALS=automation-credentials.properties
&amp;&amp; mvn install &amp;&amp; mvn sonar:sonar

mvn clean org.jacoco:jacoco-maven-plugin:prepare-agent install
	-Dmaven.test.failure.ignore=true
&amp;&amp; mvn sonar:sonar</pre>
</div>
</div>
<div class="paragraph">
<p>This creates the project in your sonar installation, allowing you to use the Eclipse SonarQube plugin from inside your Anypoint Studio. Using this plugin is the recommended way, but is always possible to run the inspections manually with * mvn sonar:sonar *.</p>
</div>
<div class="paragraph">
<p>If you are experiencing false positive issues, you can disable the inspection using //NOSONAR comment at the end of a line which has the issue on a case-by-case basis. Every use of //NOSONAR is recorded by SonarQube as an Info issue so you can track its usage in your connector’s code.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The use of //NOSONAR comments should only be used when there is full certainty that this inspection is a false positive.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, suppose you have an incorrectly capitalized method that you can’t change. This is normally a blocker issue:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/sonar-1.png" alt="sonar 1">
</div>
</div>
<div class="paragraph">
<p>After adding the //NOSONAR marker, this is no longer a blocker issue, but is marked as Info so you can track the usage of //NOSONAR throughout your project:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/sonar-2.png" alt="sonar 2">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sonarqube_eclipse_plugin_setup">SonarQube Eclipse Plugin Setup</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open Anypoint Studio, then select Help &gt; Install New Software.</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/sonar-3.png" alt="sonar 3">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the Work with text box, fill in the update site URL:
SonarQube Integration for Eclipse (update-site) - <a href="http://dist.sonar-ide.codehaus.org/eclipse/" class="bare">http://dist.sonar-ide.codehaus.org/eclipse/</a></p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/sonar-4.png" alt="sonar 4">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check the SonarQube Java option.</p>
</li>
<li>
<p>After completing the installation, restart Anypoint Studio.</p>
</li>
<li>
<p>Open Anypoint Studio’s preferences, and browse to the SonarQube section. Expand it, and select the Servers subsection. Click Add and fill in the URL and credentials for your server (by default, admin/admin).</p>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/sonar-5.png" alt="sonar 5">
</div>
</div>
<div class="paragraph">
<p>Click the <strong>Test connection</strong> button to ensure that your settings are correct.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To associate your project on the SonarQube server, perform a full analysis once. You can do this by running mvn sonar:sonar in your Connector project.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You should perform this full analysis from a machine that is on the same network as the SonarQube database, otherwise it might take very long to complete.</p>
</div>
<div class="paragraph">
<p>When your project finishes analyzing, in Studio right-click your connector project and click <strong>Configure &gt; Associate with SonarQube</strong>. Because your project was analyzed with Maven, the association detects automatically.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/sonar-6.png" alt="sonar 6">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>After association, your project is analysed with SonarQube and the results are shown on the SonarQube issues tab. Also, the Package Explorer and file editor display error and warning icons according to the issues on your project.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>New issues introduced since the previous analysis are marked as errors, while existing issues are marked as warnings. This is a cosmetic difference only, which helps to highlight new technical debt being introduced in your code before you check it in.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To analyse your project again, right-click it and click <strong>SonarQube &gt; Analyse</strong>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_quality_profile_rules">Quality Profile Rules</h2>
<div class="sectionbody">
<div class="paragraph">
<p>SonarQube classifies each issue with a severity:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Blocker &amp; Critical: Bugs or unacceptable programming practices. Your connector cannot have blocker or Critical issues to be certified. You must correct all issues.</p>
</li>
<li>
<p>Major:  These inspections fall in a similar category to the critical issues but with lower priority.</p>
</li>
<li>
<p>Minor: Correctness, clarity or performance issues that do not impact your connector’s functionality significantly.</p>
</li>
<li>
<p>Info: Keeps track of useful information that might otherwise go unnoticed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To see the full list of rules checked by SonarQube, browse to the Anypoint Connectors Certification quality profile through the web UI.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_coverage">Code Coverage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>SonarQube also lets you manage Code Coverage reports of your connector.</p>
</div>
<div class="paragraph">
<p>Generate a code coverage report in SonarQube with this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>mvn clean org.jacoco:jacoco-maven-plugin:prepare-agent install
	-Dmaven.test.failure.ignore=true &amp;&amp; mvn sonar:sonar</pre>
</div>
</div>
<div class="paragraph">
<p>After this command finishes executing, Sonar displays a report with the name of your connector. For example, this screenshot shows the Salesforce connector’s Sonar report after running every Unit test and Functional test:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/coverage-guidelines-1.png" alt="coverage guidelines 1">
</div>
</div>
<div class="paragraph">
<p>Delving further into the project details shows you a code coverage percentage on a per-class basis.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/coverage-guidelines-2.png" alt="coverage guidelines 2">
</div>
</div>
<div class="paragraph">
<p>Delving even further, it shows you the exact lines that are covered by tests and those that are not.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/coverage-guidelines-3.png" alt="coverage guidelines 3">
</div>
</div>
<div class="paragraph">
<p>Every connector method must have unit or automation tests. A connector fails certification if it does not have all its message processors, message sources, and custom transformers covered by unit tests or automation tests. Also, all the utility classes that are part of a connector must have a high level of code coverage.</p>
</div>
<div class="sect2">
<h3 id="_code_coverage_must_be_no_less_than_70">Code coverage must be no less than 70%.</h3>
<div class="paragraph">
<p>Testing your processors gives you a good indication of the quality of your connector. When you build automation tests, you are using your own connector to connect to an API. If you find it hard to test all cases of a message processor, then consider separating your message processors into smaller ones, if possible.</p>
</div>
<div class="paragraph">
<p>If your connector bases its processing around metadata, test every possible metadata entry that the API supports. As an example, the Salesforce connector supports multiple SFDC objects (such as Account, Contact, Lead etc.), but it only contains one “create” operation. Create a unit test for every metadata object to ensure proper compatibility with the message processor.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_studio_plugin_code_coverage_report">Studio Plugin Code Coverage Report</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Studio DevKit plugin rapidly generates a coverage report that shows you which operations are covered by functional tests and those that are not.</p>
</div>
<div class="paragraph">
<p>To generate a coverage report, run every functional test in your connector. Right-click your project name in Package Explorer and click <strong>Anypoint Connector &gt; Test Coverage Report</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/coverage-guidelines-4.png" alt="coverage guidelines 4">
</div>
</div>
<div class="paragraph">
<p>A Maven build process generates an HTML page that lists all the operations your tests cover and those without coverage:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/coverage-guidelines-5.png" alt="coverage guidelines 5">
</div>
</div>
<div class="sect2">
<h3 id="_ignoring_classes_from_testing">Ignoring Classes from Testing</h3>
<div class="paragraph">
<p>You should <strong>NEVER</strong> prevent classes from being tested unless there is good reason. If you feel that there is a need to ignore classes from inspection, contact either Mariano Quintela, or Paulo Gustavo Veiga. Unless explicitly stated in the code comments or in some form of internal documentation, assume that all code must be inspected. Any ignored classes or packages without proper explanation should be inspected and any blocker or critical issues that arise should be resolved, <strong>and tested</strong> by the developer before the connector is released.</p>
</div>
<div class="paragraph">
<p>There are a number of ways of ignoring classes that you do not want inspected by SonarQube:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Method level ignore:</p>
<div class="ulist">
<ul>
<li>
<p>Methods can be ignored by adding a //NOSONAR comment next to the method declaration. Example:</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> someMethodToNotInspect() { <span class="comment">//NOSONAR</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Class level ignore</p>
<div class="ulist">
<ul>
<li>
<p>It may be the case that whole classes need to be ignored because they’re not in the control of the developer. As an example, the SFDC Connector contains classes from the SFDC JAR. These had to be modified slightly to include no-args constructors for DataSense reasons. As a result, these classes have to be ignored since the code quality is not in control of the SFDC Connector developer.</p>
</li>
<li>
<p>Classes can be completely ignored by adding // NOSONAR next to the class level definition. Example:</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">MyClassThatShouldntBeInspected</span> { <span class="comment">// NOSONAR</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Package level ignore</p>
<div class="ulist">
<ul>
<li>
<p>Whole packages can be ignored by adding the “sonar.exclusions” property inside the pom.xml file. Example:</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;properties&gt;</span>
        <span class="tag">&lt;sonar.exclusions&gt;</span>src/main/java/com/sforce/**/*<span class="tag">&lt;/sonar.exclusions&gt;</span>
<span class="tag">&lt;/properties&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This ignores any file under the com.sforce package under src/main/java.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_code_quality_review_guideline">Code Quality Review Guideline</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a hard area to tackle because typically, the person running certification is different from the one implementing the connector and writing tests for it. As a result, you might inspect the code and be completely lost.</p>
</div>
<div class="paragraph">
<p>If code documentation is not sufficient, point this out to the developer and PM.</p>
</div>
<div class="paragraph">
<p>As you try to understand the code, you might run into certain code pieces that you’re not sure why they’re there. As an example, PeopleSoft contained synchronous code and some time was spent by the developer understanding why they were there. It turns out that they were not needed, and were causing a degree of locking when working with concurrent requests. If you think that there are code blocks that feel out of place, mention it to the developer or PM.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_studio_interoperability_qa">Studio Interoperability QA</h2>
<div class="sectionbody">
<div class="sect1">
<h2 id="_purpose">Purpose</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Based on these guidelines, partners should analyze the connector under test and provide a test suite build from these generic test cases (only a document with general and operation­specific test cases titles) with all tests in "Passed" status.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_oauth_authentication">OAuth Authentication</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_oauth_global_configuration_element">OAuth - Global Configuration Element</h3>
<div class="sect3">
<h4 id="_preconditions">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Mule project was created and is open.</p>
</li>
<li>
<p>Connector code is available in order to review configurations.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas</p>
</li>
<li>
<p>Drop the desired connector inside the flow.</p>
</li>
<li>
<p>Select it and click the Config Reference Edit button.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

 * Connector class attributes marked as @Configurable display.
 * consumerKey and consumerSecret are annotated with @OAuthConsumerKey and @OAuthConsumerSecret.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong> Enter valid credentials and save.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Global Configuration element is created and saved.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_oauth_project_arrangement_and_configuration_verification">OAuth - Project Arrangement and Configuration Verification</h3>
<div class="paragraph">
<p>Build this test case to serve as the basis for the next set of test cases.</p>
</div>
<div class="sect3">
<h4 id="_preconditions_2">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global element was already created for the connector and valid OAuth credentials (consumerKey, consumerSecret, and callback URL) have been entered.</p>
</li>
<li>
<p>Connector code is available in order to review configurations.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_2">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Arrange a flow in the following way:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop two consecutive connectors in the flow.</p>
</li>
<li>
<p>Drop a Logger after the last connector.</p>
</li>
<li>
<p>Finally, add a Set Payload element after the
logger.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Flow arrangement looks similar to this:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-1.png" alt="qa guidelines 1">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong> On the HTTP endpoint, set a path value of "authorize".</p>
</li>
<li>
<p><strong>Step 3:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select the first connector.</p>
</li>
<li>
<p>Look for the Authorize operation.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Authorize operation is found.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select the Authorize operation.</p>
</li>
<li>
<p>Check the General section.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Input fields are found for:
* State (only for OAuth2)
* Access Token URL
* Authorization URL</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 5:</strong> Look for the authorizationParameters inside the OAuth annotation.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Each of the annotations on authorizationParameters are reflected in the Additional Authorization Parameters section. If none, the section is not displayed at all.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 6:</strong> In case of OAuth2m set a state value of "testState". Click <strong>Save</strong></p>
</li>
<li>
<p><strong>Step 7:</strong> On the second connector, select any operation (besides Authorize and Unauthorize) and configure it. Then click <strong>Save</strong>.</p>
</li>
<li>
<p><strong>Step 8:</strong> Set "Operation payload is #[message.payload]" as the Logger message value. Then click <strong>Save</strong>.</p>
</li>
<li>
<p><strong>Step 9:</strong> Arrange a flow in the following way:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop a connector in the flow.</p>
</li>
<li>
<p>Drop a Logger after the last connector.</p>
</li>
<li>
<p>Finally, add a Set Payload element after the logger.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Flow arrangement looks similar to this:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-2.png" alt="qa guidelines 2">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 10:</strong> On the HTTP endpoint, set a path value of "anoperation".</p>
</li>
<li>
<p><strong>Step 11:</strong> On the connector, select any operation (besides Authorize and Unauthorize) and configure it. Then click <strong>Save</strong>.</p>
</li>
<li>
<p><strong>Step 12:</strong> Set "Operation payload is #[message.payload]" as the Logger message value. Then click <strong>Save</strong>.</p>
</li>
<li>
<p><strong>Step 13:</strong> Arrange a flow in the following way:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop a connector in the flow.</p>
</li>
<li>
<p>Drop a Logger after the last connector.</p>
</li>
<li>
<p>Finally, add a Set Payload element after the
logger.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Flow arrangement looks similar to this:
image::{imagesdir}/qa-guidelines/qa-guidelines-3.png[]</pre>
</div>
</div>
<div class="paragraph">
<p>￼
* <strong>Step 14:</strong> On the connector, look for the Unauthorize operation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Unauthorize operation is found.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 15:</strong> Select the Unauthorize operation. Then click <strong>Save</strong>.</p>
</li>
<li>
<p><strong>Step 16:</strong> Set "Done." on all Set Payload elements Values. Then click <strong>Save</strong>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">Expected Result:

Example of the flows on the project .mflow :

<span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">authorize</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">authorize</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;http:inbound-endpoint</span> <span class="attribute-name">exchange-pattern</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">request-response</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${http.port}</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">authorize</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

        <span class="tag">&lt;sfdc:authorize</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce__OAuth_</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">display</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">POPUP</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Authorize</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>

        <span class="comment">&lt;!-- &lt;sfdc:authorize config-ref=&quot;Salesforce__OAuth_&quot; display=&quot;POPUP&quot;
        doc:name=&quot;Authorize&quot;/&gt; --&gt;</span>

        <span class="tag">&lt;sfdc:get-user-info</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce__OAuth_</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Get user info</span><span class="delimiter">&quot;</span></span> <span class="tag">&gt;</span>
        <span class="tag">&lt;/sfdc:get-user-info&gt;</span>

        <span class="tag">&lt;logger</span> <span class="attribute-name">message</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[message.payload]</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Logger</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;set-payload</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Done.</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Set Payload</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/flow&gt;</span>

<span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">aConnectorOperation</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">aConnectorOperation</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;http:inbound-endpoint</span> <span class="attribute-name">exchange-pattern</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">request-response</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">8081</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">anoperation</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;sfdc:describe-global</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce__OAuth_</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Describe global</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;logger</span> <span class="attribute-name">message</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[message.payload]</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Logger</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;set-payload</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Done.</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Set Payload</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/flow&gt;</span>

<span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unauthorize</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unauthorize</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;http:inbound-endpoint</span> <span class="attribute-name">exchange-pattern</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">request-response</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">8081</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">unauthorize</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;sfdc:unauthorize</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce__OAuth_</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Unauthorize</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;set-payload</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Done.</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Set Payload</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
 <span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_oauth_authorized_connector_requests">OAuth - Authorized Connector Requests</h3>
<div class="sect3">
<h4 id="_preconditions_3">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global element was already created for the connector and valid OAuth credentials (consumerKey, consumerSecret and callback URL) have been entered.</p>
</li>
<li>
<p>OAuth ­ Project arrangement and configuration verifications test case was completed successfully</p>
</li>
<li>
<p>Connector code is available in order to review configurations.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_3">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the app and hit the authorize endpoint.</p>
</li>
<li>
<p>Complete the OAuth dance.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
* Redirects to the authorization URL of the service provider, which occurs according to authorizationParameters.
* Access is granted.
* Callback URL is shown in the browser address bar.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong>
Check the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Operation payload is logged.

This implies that the logic contained in the @OAuthPostAuthorization to establish connections to make requests was executed.
Check the State parameter</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Hit the anoperation endpoint.</p>
</li>
<li>
<p>Check the console.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Operation payload is logged.

This implies that Mule included the access token (contained within the parameters annotated with @OAuthAccessToken) in the request to the service provider.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Hit the unauthorize endpoint.</p>
</li>
<li>
<p>Check the console.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
OAuth session is killed.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_oauth_unauthorize_connector_requests">OAuth - Unauthorize Connector Requests</h3>
<div class="sect3">
<h4 id="_preconditions_4">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global element was already created for the connector and valid OAuth credentials (consumerKey, consumerSecret and callback URL) have been entered.</p>
</li>
<li>
<p>OAuth ­ Project arrangement and configuration verifications test case was completed successfully</p>
</li>
<li>
<p>Connector code is available in order to review configurations.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_4">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Run the app and hit the anoperation endpoint.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
The consumer operation throws a NotAuthorizedException.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Hit the authorize endpoint.</p>
</li>
<li>
<p>Complete the OAuth dance.</p>
</li>
<li>
<p>Check the console.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Operation payload is logged.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Hit the unauthorize endpoint.</p>
</li>
<li>
<p>Check the console.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
OAuth session is killed.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Hit the anoperation endpoint.</p>
</li>
<li>
<p>Check the console.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
The consumer operation throws a NotAuthorizedException.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 5:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Hit the unauthorize endpoint.</p>
</li>
<li>
<p>Check the console.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Flow is run. No exception is thrown.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_oauth_access_token_expiration">OAuth - Access Token Expiration</h3>
<div class="sect3">
<h4 id="_preconditions_5">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global element was already created for the connector and valid OAuth credentials (consumerKey, consumerSecret and callback URL) have been entered.</p>
</li>
<li>
<p>OAuth ­ Project arrangement and configuration verifications test case completed successfully.</p>
</li>
<li>
<p>Connector code is available in order to review configurations.</p>
</li>
<li>
<p>Regular expression for the expirationRegex parameter was specified on the OAuth2 annotation.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_5">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Hit the authorize endpoint.</p>
</li>
<li>
<p>Complete the OAuth dance.</p>
</li>
<li>
<p>Check the console.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Operation payload is logged.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong> Meet access token expiration criteria.</p>
</li>
<li>
<p><strong>Step 3:</strong> Hit the anoperation endpoint.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Expiration is detected and OAuth dance is triggered.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Complete the OAuth dance.</p>
</li>
<li>
<p>Check the console.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Operation payload is logged.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_oauth_operation_not_supported_due_to_scope_parameter">OAuth - Operation Not Supported Due to Scope Parameter</h3>
<div class="sect3">
<h4 id="_preconditions_6">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global element was already created for the connector and valid OAuth credentials (consumerKey, consumerSecret and callback URL) have been entered.</p>
</li>
<li>
<p>OAuth ­ Project arrangement and configuration verifications test case was completed successfully.</p>
</li>
<li>
<p>Connector code is available in order to review configurations.</p>
</li>
<li>
<p>Connector declares a @OAuthScope attribute.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_6">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Open the Global Configuration element of the Connector and set a valid Scope value that&#8217;s not supported by the operation on the authorize flow.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Scope value is overridden.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the app and hit the authorize endpoint.</p>
</li>
<li>
<p>Complete the OAuth dance.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
* Redirects to the authorization URL of the service provider that occurs according to authorizationParameters
* Access is granted.
* Callback URL is shown in the browser
address bar.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong> Check the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
No permission to access resource error displays.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Hit the unauthorize endpoint.</p>
</li>
<li>
<p>Check the console.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
OAuth session is killed.</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_anypoint_studio_interoperability_testing">Anypoint Studio Interoperability Testing</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_anypoint_studio_installation">Anypoint Studio Installation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_anypoint_studio_installation_wizard">Anypoint Studio - Installation Wizard</h3>
<div class="sect3">
<h4 id="_preconditions_7">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Anypoint Studio is installed on the local machine.</p>
</li>
<li>
<p>Connector already available on the update site.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_7">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> In Anypoint Studio click <strong>Help &gt; Install New Software</strong></p>
</li>
<li>
<p><strong>Step 2:</strong> From the <strong>Work with</strong> dropdown select <strong>Anypoint Studio Connectors Update Site</strong></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Connector categories are listed.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong> Search for the &lt;connectorName&gt;.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Connector matching criteria displays. Format should be:
&lt;connectorCategory&gt;
Mule &lt;connectorName&gt; Connector (Mule 3.5+)
Mule &lt;connectorName&gt; Connector Anypoint Studio Extension
Refer to screenshot.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-4.png" alt="qa guidelines 4">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong> Click the connector.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Details text area updates to display connector information.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 5:</strong>: Check the connector version and click Next.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Install Details step displays.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 6:</strong> Click Next.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Review Licenses step displays. The license text content loads and applies to the connector category.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 7:</strong> Click Finish.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Installation starts. No unsigned content warning is displayed during installation.
Anypoint Studio is restarted after installation.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-5.png" alt="qa guidelines 5">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 8:</strong> After Anypoint Studio finishes loading, search for &lt;connectorName&gt;.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Connector displays under the Connectors category.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_anypoint_studio_icons">Anypoint Studio - Icons</h3>
<div class="sect3">
<h4 id="_preconditions_8">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Anypoint Studio is installed on the local machine.</p>
</li>
<li>
<p>Connector already installed.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_8">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Search for the &lt;connectorName&gt;.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Icon displays on the Palette, which relates to the service the connector connects to.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong> Drop a Flow element on the canvas. Afterwards select the connector from the Palette and place it within the Flow.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Icon displays and relates to the service the connector connects to.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong> If MessageSources are supported by the connector drag the connector from the Palette to the Canvas.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Message Source icon for the connector displays.</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_multiple_extensions">Multiple Extensions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_anypoint_studio_multiple_extensions_installed_3_5_x_server_runtime">Anypoint Studio - Multiple Extensions Installed - 3.5.x Server Runtime</h3>
<div class="sect3">
<h4 id="_preconditions_9">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Anypoint Studio is installed on the local machine.</p>
</li>
<li>
<p>3.5.0 runtime project was created.</p>
</li>
<li>
<p>3.5.0 and 3.4.x version of the connector are already installed.</p>
</li>
<li>
<p><strong>Step 1:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Search for the &lt;connectorName&gt;.</p>
</li>
<li>
<p>Drop a Flow element on the canvas.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Step 2:</strong> Drag the connector from the Palette and place it within the Flow.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Select a version ... dialog appears.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong> Click Use newest</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
* Connector is added to the canvas.
* Connector related library is added to project.
Version corresponds to the 3.5.0 connector.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-6.png" alt="qa guidelines 6">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong> Secondary click on the connector and select remove libraries for project.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Library is removed from project.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 5:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Remove the connector from the canvas.</p>
</li>
<li>
<p>Drag the connector from the Palette and place it within the Flow.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Select a version ... dialog appears.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 6:</strong> Click Choose manually.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
* Connector is added to the canvas.
* Connector related library is added to project.
Version corresponds to the 3.5.x connector.

image::{imagesdir}/qa-guidelines/qa-guidelines-7.png[]</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 7:</strong>￼ Secondary click on the connector and select remove libraries for project.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Library is removed from the project.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 8:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Remove the connector from the canvas.</p>
</li>
<li>
<p>Drag the connector from the Palette and place it within the Flow.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Select a version ... dialog appears.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 9:</strong> Click Choose manually.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
* Select extension version screen displays.
* For the 3.5.0 version, check that the library version matches the one previously displayed.
* For the 3.4.x version, schema version displays.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-8.png" alt="qa guidelines 8">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 9:</strong> Randomly select one of options and click Ok.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Connector is added to the canvas. Check that the library version matches the one previously displayed for that version.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_anypoint_studio_multiple_extensions_installed_3_5_x_server_runtime_message_sources">Anypoint Studio - Multiple Extensions Installed - 3.5.x Server Runtime - Message Sources</h3>

</div>
<div class="sect2">
<h3 id="_anypoint_studio_multiple_extensions_installed_3_4_x_server_runtime">Anypoint Studio - Multiple Extensions Installed - 3.4.x Server Runtime</h3>

</div>
<div class="sect2">
<h3 id="_anypoint_studio_multiple_extensions_installed_3_4_x_connector_running_on_3_5_x_server_runtime">Anypoint Studio - Multiple Extensions Installed - 3.4.x Connector Running on 3.5.x Server Runtime</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_global_element_properties">Global Element Properties</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_global_element_properties_basic_authentication_connectors_hidden_password_text">Global Element Properties - Basic Authentication Connectors - Hidden Password Text</h3>
<div class="sect3">
<h4 id="_steps_9">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Open Global Element.</p>
</li>
<li>
<p><strong>Step 2:</strong> Populate password field.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Password field’s text is hidden by default.</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_connectivity">Connectivity</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is part of connection management.</p>
</div>
<div class="sect2">
<h3 id="_oauth_connectors">OAuth Connectors</h3>
<div class="sect3">
<h4 id="_connectivity_oauth_connectors_test_connectivity_button_not_available">Connectivity - OAuth Connectors - Test Connectivity Button Not Available</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Open Global Configuration element.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Test connectivity &#8230;&#8203; button is not available.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_non_oauth_connectors">Non-OAuth connectors</h3>
<div class="paragraph">
<p>For the following tests, the connector has connectivity.</p>
</div>
<div class="sect3">
<h4 id="_connectivity_non_oauth_connectors_positive_string_values">Connectivity - Non-OAuth Connectors - Positive - String Values</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Open Global Configuration element.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Test connectivity &#8230;&#8203; button is available.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Populate all Connection mandatory fields with valid credentials and click the Test connectivity &#8230;&#8203; button.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Test connection successful is returned.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_connectivity_non_oauth_connectors_positive_placeholders_as_credentials">Connectivity - Non-OAuth Connectors - Positive - Placeholders as Credentials</h4>
<div class="paragraph">
<p><strong>Preconditions</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>mule.properties file contains properties values that are under src/main/resources.</p>
</li>
<li>
<p>Property placeholder element referencing mule.properties was created.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Open Global Configuration element.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Test connectivity &#8230;&#8203; button is available.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Populate all Connection mandatory fields with property placeholders and click the Test connectivity &#8230;&#8203; button.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Test connection successful is returned.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_connectivity_non_oauth_connectors_negative_invalid_credentials">Connectivity - Non-OAuth Connectors - Negative - Invalid Credentials</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Open Global Configuration element.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Test connectivity &#8230;&#8203; button is available.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">One at the time, enter an invalid value on each of the Connection mandatory fields and click the Test connectivity &#8230;&#8203; button.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Test connection failed is returned. org.mule.api.ConnectionException is raised stating a useful error message to the user.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_connectivity_non_oauth_connectors_negative_empty_fields">Connectivity - Non-OAuth Connectors - Negative - Empty Fields</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Open Global Configuration element.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Test connectivity &#8230;&#8203; button is available.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">One at the time, leave empty the value of one of the Connection mandatory fields and click the Test connectivity &#8230;&#8203; button.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Test connection failed is returned. org.mule.api.ConnectionException is raised stating a useful error message to the user.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_metadata">Metadata</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_dynamic_metadata">Dynamic Metadata</h3>
<div class="paragraph">
<p>Supported by Non­OAuth connectors.</p>
</div>
<div class="sect3">
<h4 id="_dynamic_metadata_enable_datasense_positive_string_values">Dynamic Metadata - Enable DataSense - Positive - String Values</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Open Global Configuration element.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Enable DataSense checkbox displays and is checked by default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Populate all Connection mandatory fields with valid credentials and click Ok.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Getting DataSense metadata types finishes successfully and configuration is saved.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dynamic_metadata_enable_datasense_positive_placeholders_as_credentials">Dynamic Metadata - Enable DataSense - Positive - Placeholders as Credentials</h4>
<div class="paragraph">
<p><strong>Preconditions</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>mule.properties file contains properties values that are under src/main/resources.</p>
</li>
<li>
<p>Property placeholder element referencing mule.properties was created.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Open Global Configuration element.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Enable DataSense checkbox displays and is checked by default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Populate all Connection mandatory fields with property placeholders and click the Test connectivity &#8230;&#8203; button.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Getting DataSense metadata types finishes successfully and configuration is saved.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Run the following set of test cases at operation level. For each of the connector operations, evaluate which set of the following test cases applies. Also, take into account that more than one attribute of an operation supports this configuration.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Open Global Configuration element.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Enable DataSense checkbox displays and is checked by default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Populate all Connection mandatory fields with property placeholders and click OK.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Getting DataSense metadata types doesn&#8217;t display and the configuration is saved.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dynamic_metadata_enable_datasense_positive_disable_datasense">Dynamic Metadata - Enable DataSense - Positive - Disable DataSense</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Open <strong>Global Configuration element</strong>.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><strong>Enable DataSense</strong> checkbox displays and is checked by default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Populate all <strong>Connection</strong> mandatory fields with valid credentials.</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Uncheck Enable DataSense checkbox.</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Click <strong>OK</strong>.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Getting DataSense metadata types doesn&#8217;t display and the configuration is saved.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_dynamic_metadata_enable_datasense_negative_invalid_credentials">Dynamic Metadata - Enable DataSense - Negative - Invalid Credentials</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Open Global Configuration element.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Enable DataSense checkbox displays and is checked by default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">One at the time, leave empty the value of one of the Connection mandatory fields and click OK.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Getting DataSense metadata types fails. org.mule.api.ConnectionException is raised stating a useful error message to the user.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <a href="http://mulesoft.github.io/marketo-connector/mule/marketo-config.html#sync-lead">sync­lead operation of the Marketo connector</a> is used to demonstrate.</p>
</div>
</div>
<div class="sect3">
<h4 id="_dynamic_metadata_xml_generation_custom_entities_and_fields_object_attributes_defined_through_the_object_builder">Dynamic Metadata - XML Generation - Custom Entities and Fields - Object Attributes Defined Through the Object Builder</h4>
<div class="paragraph">
<p><strong>Preconditions</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>On the connector, Global Configuration DataSense is enabled and DataSense metadata types were fetched successfully.</p>
</li>
<li>
<p>In the Anypoint Studio canvas, place a connector building block inside a flow.</p>
</li>
<li>
<p>Connector was selected.</p>
</li>
<li>
<p>Operation under test consumes an entity for which a custom entity or custom fields on an entity were defined on the service.</p>
</li>
<li>
<p>No DataSense metadata was fetched for the operation under test.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">On the General tab select the corresponding Config reference.</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Select the operation.</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Select an Object type (if not already defined by default by the operation) that&#8217;s custom or has a custom field.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">List of Object types display based on the retrieved metadata from the service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">For the child elements, select the Create Objects manually option and click the &#8230;&#8203; button.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Getting DataSense metadata &#8230;&#8203; popup displays. Object builder displays Objects fields. Defined custom field displays among them.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Populate the desired object fields and click OK.</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Save and change to the <strong>Configuration XML</strong> view.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Operation configuration is reflected on the XML. Example XML:
----
&lt;marketo:sync-lead config-ref="Marketo" doc:name="Marketo"&gt;
&lt;marketo:lead-record &gt;
&lt;marketo:lead-record key="City"&gt;#[flowVars['City']]&lt;/marketo:lead-r ecord&gt;
&lt;marketo:lead-record key="AnnualRevenue"&gt;#[flowVars['AnnualRevenue' ]]&lt;/marketo:lead-record&gt;
&lt;marketo:lead-record key="Department"&gt;#[flowVars['Department']]&lt;/ma rketo:lead-record&gt;
&lt;marketo:lead-record key="Company"&gt;#[flowVars['Company']]&lt;/marketo: lead-record&gt;
&lt;/marketo:lead-record&gt; &lt;/marketo:sync-lead&gt;
----</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_static_metadata">Static Metadata</h3>
<div class="paragraph">
<p>In case of static metadata, Anypoint Studio retrieves the POJO, List&lt;POJO&gt;, or Map&lt;String,POJO&gt;attribute from the connector code.</p>
</div>
<div class="paragraph">
<p>OAuth connectors with static metadata support:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Salesforce (Non­OAuth)</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_static_metadata_non_datasense_enabled">Static Metadata - Non DataSense-Enabled</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Open Global Configuration element.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Enable DataSense checkbox is not displayed.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Run the following set of test cases at operation level. For each of the connector operations, evaluate which set of the following test cases applies. Also, take into account that more than one attribute of an operation supports this configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="_static_metadata_xml_generation_object_attributes_defined_through_the_object_builder">Static Metadata - XML Generation - Object Attributes Defined Through the Object Builder</h4>
<div class="paragraph">
<p><strong>Preconditions</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>On the connector Global Configuration, DataSense metadata types were fetched successfully.</p>
</li>
<li>
<p>In the Anypoint Studio canvas, a connector building block was placed inside a flow.</p>
</li>
<li>
<p>Connector is selected.</p>
</li>
<li>
<p>No DataSense metadata was fetched for the operation under test.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">On the General tab, select the corresponding Config reference.</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Select the operation.</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Randomly select an Object type (if not already defined by default by the operation).</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Object types are based on the metadata retrieved from the connector.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">For the child elements, select the Create Objects manually option and click the &#8230;&#8203; (browse) button.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Getting DataSense metadata &#8230;&#8203; popup displays. Object builder displays Objects fields.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Populate the desired object fields and click OK.</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Save and change to the Configuration XML view.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Operation configuration is reflected on the XML.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_metadata_xml_generation">Metadata / XML Generation</h3>
<div class="sect3">
<h4 id="_metadata_xml_generation_non_oauth_positive_object_attributes_not_defined">Metadata - XML Generation - Non-OAuth - Positive - Object Attributes Not Defined</h4>
<div class="paragraph">
<p><strong>Preconditions</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Non­OAuth connectors that support dynamic metadata, on the connector Global Configuration DataSense was enabled and DataSense metadata types were fetched successfully.</p>
</li>
<li>
<p>In the Anypoint Studio canvas, a connector building block was placed inside of a flow.</p>
</li>
<li>
<p>Connector was selected.</p>
</li>
<li>
<p>No DataSense metadata was fetched for the operation under test yet.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">On the General tab select the corresponding Config reference.</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Select the operation.</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Randomly select an Object type (if not already defined by default by the operation).</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">As child elements, select the None option.</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Save</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Save and change to the Configuration XML view.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Getting DataSense metadata &#8230;&#8203; popup displays.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_metadata_xml_generation_non_oauth_positive_object_attributes_passed_by_reference">Metadata - XML Generation - Non-OAuth - Positive - Object Attributes Passed by Reference</h4>
<div class="paragraph">
<p><strong>Preconditions</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Non­OAuth connectors that support dynamic metadata, on the connector Global Configuration, DataSense was enabled and DataSense metadata types were fetched successfully.</p>
</li>
<li>
<p>In the Anypoint Studio canvas, a connector building block was placed inside a flow.</p>
</li>
<li>
<p>Connector was selected.</p>
</li>
<li>
<p>No DataSense metadata was fetched for the operation under test.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-middle">Step</th>
<th class="tableblock halign-left valign-middle">Description</th>
<th class="tableblock halign-left valign-middle">Expected Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">On the General tab select the corresponding Config reference.</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Select the operation.</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Randomly select an Object type (if not already defined by default by the operation).</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">For the child elements, select the From Message option and enter #[flowVars['objectRef']]as the value.</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Save.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Getting DataSense metadata &#8230;&#8203; popup displays.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-middle"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Change to the Configuration XML view.</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Operation configuration is reflected on the XML. Example XML above</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;code&gt;</span>
        <span class="tag">&lt;marketo:sync-lead</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Marketo</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Marketo</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;marketo:lead-record</span> <span class="attribute-name">ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[flowVars['leadRecordRef']]</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/marketo:sync-lead&gt;</span>
<span class="tag">&lt;/code&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_no_metadata">No Metadata</h4>
<div class="paragraph">
<p>This is defined by the argument types and return types of the API. If all of them are either primitive types or of type InputStream, the connector falls in the No metadata category.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_xml_generation">XML Generation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_xml_generation_pojo_by_reference_or_expression_or_define_attributes">XML Generation - POJO by ‘Reference or expression’ or ‘Define attributes’</h3>
<div class="sect3">
<h4 id="_steps_10">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> On the General tab select the corresponding Config reference.</p>
</li>
<li>
<p><strong>Step 2:</strong> Select the operation.</p>
</li>
<li>
<p><strong>Step 3:</strong> For the POJO no option is available by default.</p>
</li>
<li>
<p><strong>Step 4:</strong> Select the Reference or expression option and enter #[flowVars[‘ref’]]as the value.
Example:
image::assets/qa-guidelines/qa-guidelines-9.png[]</p>
</li>
<li>
<p><strong>Step 5:</strong>
Save and change to the Configuration XML view.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">Expected Result: XML for the operation was generated using the ref attribute.
Example XML:

<span class="tag">&lt;sfdc:batch-info</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce</span><span class="delimiter">&quot;</span></span> <span class="tag">&gt;</span>
<span class="tag">&lt;sfdc:batch-info</span> <span class="attribute-name">ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[flowVars['batchInfoRef']]</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span> <span class="tag">&lt;/sfdc:batch-info&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 6:</strong> Return to the Message Flow view, click the connector.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Same operation is selected, Reference or expression is selected for the POJO and the value was stored.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 7:</strong>
￼For the same POJO select the Define attributes option and enter #[flowVars[‘pojoAttribute’]] for the Id and Job Id values.
Example:
image::assets/qa-guidelines/qa-guidelines-10.png[]</p>
</li>
<li>
<p><strong>Step 8:</strong> Save and change to the Configuration XML view.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">Expected Result:
XML for the operation was generated defining each of the POJO attributes.
Example XML:
<span class="tag">&lt;sfdc:batch-info</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce</span><span class="delimiter">&quot;</span></span> <span class="tag">&gt;</span>
<span class="tag">&lt;sfdc:batch-info</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[flowVars['id']]</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">jobId</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[flowVars['jobId']]</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">state</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Completed</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/sfdc:batch-info&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 9:</strong>  Return to the Message Flow view, click on the connector.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Same operation is selected, Define attributes is selected for the POJO and the attributes values were stored.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_xml_generation_attribute_names_consistency">XML Generation - Attribute Names Consistency</h3>
<div class="paragraph">
<p>Operations attributes names should be the same as the ones from the API, but in case, this rule introduces inconsistencies among operations; then the parameter name should be corrected in the connector. As an example:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Library/API method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expected result</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.eclipse.egit.github.core.<br>
service.GistService.del eteGist(String gistId)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Processor<br>
public void deleteGist(String gistId) throws IOException {<br>
&#8230;&#8203; }</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.eclipse.egit.github.core.<br>
service.GistService.get Gist(String id)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Processor<br>
public Gist getGist(String gistId) throws IOException {<br>
&#8230;&#8203; }</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_xml_generation_attribute_order">XML Generation - Attribute Order</h3>
<div class="paragraph">
<p>Order of operation attributes should be the same as in the API. Attributes generated in the wrong order cause errors in the XML at runtime.</p>
</div>
</div>
<div class="sect2">
<h3 id="_xml_generation_required_attribute_value_not_defined">XML generation - Required Attribute Value not Defined</h3>
<div class="sect3">
<h4 id="_preconditions_10">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Applies to operations directly exposing fields (with no default value) on the Mule Properties View.</p>
</li>
<li>
<p>In the Anypoint Studio canvas a connector building block was placed inside of a flow.</p>
</li>
<li>
<p>Connector is selected.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_11">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> On the General tab select the corresponding Config reference.</p>
</li>
<li>
<p><strong>Step 2:</strong> Select the operation.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Operation required attributes values display as missing.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-11.png" alt="qa guidelines 11">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong> Look for the operation in the API docs.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Required attributes match with the ones marked as such in the Mule Properties View.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong> Back in Anypoint Studio, change to the Problems tab.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
'Required attribute not defined' error is logged.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-12.png" alt="qa guidelines 12">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_message_sources">Message Sources</h3>
<div class="paragraph">
<p>Methods annotated with @Source(). They are common for connectors to services with streaming APIs.</p>
</div>
<div class="sect3">
<h4 id="_preconditions_11">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Mule project was created and is open.</p>
</li>
<li>
<p>Global Configuration element is already created with valid credentials to the service.</p>
</li>
<li>
<p>Connector code is available in order to review configurations</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_12">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Pull the desired connector to the canvas.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Connector is created as endpoint to a flow.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-13.png" alt="qa guidelines 13">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place a Logger next to it.</p>
</li>
<li>
<p>Set "Message Source received <code>#[message.payload]" as its Message.</code></p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Step 3:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the Global Configuration Element to the connector.</p>
</li>
<li>
<p>Check the available operations.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Operations on the dropdown match to methods marked as @Source on the connector code.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong>  Select the Message Source under test and configure it appropriately.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">Expected Result:

Example of a Mule flow:
<span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SubscribeToTopic</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SubscribeToTopic</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;sfdc:subscribe-topic</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">topic</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/ContactsDemo</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Subscribe To newAccountMessages Topic</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;logger</span> <span class="attribute-name">level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">message</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">New account notification received: #[message.payload]</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Notification</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 5:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Run the Mule app.</p>
</li>
<li>
<p>Check the Console.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Initialization message is logged:
INFO 2014-01-1317:59:17,210[HttpClient-29] org.mule.modules.salesforce.SalesforceBayeuxClient: subscribing /topic/ContactsDemo for the first time</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 6:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Trigger the event the Message Source is expecting.</p>
</li>
<li>
<p>Check the Console.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Message Source response was logged.</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_datamapper_compliance_2">DataMapper Compliance</h2>
<div class="sectionbody">
<div class="paragraph">
<p>DataMapper automatic metadata population is defined by the message processor attributes’ annotations as well as the message processor&#8217;s return type.</p>
</div>
<div class="paragraph">
<p>In the case of POJO operation attributes, at least one of them must be marked as <code>@Optional</code>. <code>@Default("#[payload]")</code> causes data to be automatically picked up in DataMapper.</p>
</div>
<div class="paragraph">
<p>If custom fields can be defined for objects in the service domain, choose them for testing DataMapper compatibility.</p>
</div>
<div class="sect2">
<h3 id="_datamapper_compliance_dynamics_static_metadata_perceptive_flow_design">DataMapper Compliance - Dynamics/Static Metadata - Perceptive Flow Design</h3>
<div class="sect3">
<h4 id="_preconditions_12">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>In the connector code @Connect contains metaData = MetaDataSwitch.OFF</p>
</li>
<li>
<p>Flow contains a connector-datamapper-connector building block arrangement that is on the canvas.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_13">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Configure both connectors with the same operation.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Metadata is fetched for both configurations.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong> Select the DataMapper building block.</p>
</li>
<li>
<p><strong>Step 3:</strong> Check the Input panel.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
 Mule automatically prescribes the output of the operation for any of the following return types:
* Map
* POJO
* List&lt;Map&gt;
* List&lt;String&gt;
* List&lt;POJO&gt;
* List&lt;List&lt;String&gt;&gt;

Check that values match the operation signature.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong> Check the Output panel.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
Mule automatically prescribes the input of the operation only for an attribute of the following type:
* Map
* POJO
* List&lt;Map&gt;
* List&lt;String&gt;
* List&lt;POJO&gt;
* List&lt;List&lt;String&gt;&gt;

Check that it's marked as `@Default("#[payload]")` (for connectors older than 3.5.0-M4). The correct annotations should be `@Optional @Default(“#[payload]”)`</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 5:</strong>  Check the operation attributes in the API docs.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
The attribute marked as `@Default("#[payload]")` (for connectors older than 3.5.0-M4). The correct annotations should be `@Optional @Default(“#[payload]”)` (aka PRIMARY argument) should be:
* An entity related to the service in case more than one applies.
* An entity that can't be created and is necessarily another operation return type (if applicable) .</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_datamapper_compliance_generate_mapping_from_the_return_type">DataMapper Compliance - Generate Mapping From the Return Type</h3>
<div class="sect3">
<h4 id="_preconditions_13">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Flow contains a connector­datamapper building block arrangement that is on the canvas.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Steps</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Expected result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure the connector with an operation returning POJO / List&lt;POJO&gt;, Map&lt;String,POJO&gt;, or List&lt;Map&lt;String, Object&gt;&gt;.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metadata is fetched for both configurations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select the DataMapper building block.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check the Input panel.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Values are pre­populated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In the Output panel select Type XML.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Click on the User Defined radio button.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Click Generate default.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate mapping using default XML schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relationship is established.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_datamapper_compliance_generate_mapping_to_operation_attribute">DataMapper Compliance - Generate Mapping to Operation Attribute</h3>
<div class="sect3">
<h4 id="_preconditions_14">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Flow contains a datamapper­connector building block arrangement that is on the canvas.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Steps</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Expected result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure the connector with an operation that has either a POJO / List&lt;POJO&gt;, Map&lt;String,POJO&gt;, or List&lt;Map&lt;String, Object&gt;&gt; as its main argument.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metadata is fetched for both configurations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select the DataMapper building block.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check the Output panel.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Values were pre­populated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In the Input panel select Type XML.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Click on the User Defined radio button.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Click Generate default.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Generate mapping using default XML schema</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relationship is established.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_datamapper_compliance_override_metadata">DataMapper Compliance - Override Metadata</h3>
<div class="sect3">
<h4 id="_preconditions_15">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Flow contains a connector­datamapper­connector building block arrangement that is on the canvas.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Steps</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Expected result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure both connectors with the same operation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metadata is fetched for both configurations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select the DataMapper building block.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check the Input and Output panel.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Values were pre­populated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The following steps are to be repeated for both the Output Panel and Input panel.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Override the provided metadata by clicking Change Type.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select the connector from the Connector dropdown.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Make sure By Operation is selected and select the operation under test from the Operation dropdown.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Click the Object dropdown.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operation return type is available in the dropdown.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_datamapper_compliance_dynamic_metadata_custom_entities_fields">DataMapper Compliance - Dynamic Metadata - Custom Entities/Fields</h3>
<div class="paragraph">
<p>This test case applies to connectors to services that support custom entities or custom fields in their entities.</p>
</div>
<div class="sect3">
<h4 id="_preconditions_16">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>On the Global Configuration, DataSense is enabled and DataSense metadata types were fetched.</p>
</li>
<li>
<p>Flow contains a connector­datamapper­connector building block arrangement that is on the canvas.</p>
</li>
<li>
<p>Operation either consumes or returns an entity for which a custom entity or custom fields on an entity were defined on the service.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_14">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Configure both connectors with the same operation. For type, select the custom entity under test or the entity for which custom fields were defined on the sandbox.
For example:
image::assets/qa-guidelines/qa-guidelines-14.png[]</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Metadata is fetched for both configurations.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong> Select the DataMapper building block.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Values were pre­populated and relate to the entity under test.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>The following step is to be run for either the Output Panel/Input panel.</strong></p>
</li>
<li>
<p><strong>Step 3:</strong> Generate a mapping (use a default map on the counter panel if necessary).</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Relationship is established.
DataMapper displays the custom entity or the custom fields of the entity under test.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-15.png" alt="qa guidelines 15">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_datamapper_compliance_no_metadata_perceptive_flow_design">DataMapper Compliance - No Metadata - Perceptive Flow Design</h3>
<div class="sect3">
<h4 id="_preconditions_17">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>In the connector code @Connect contains metaData = MetaDataSwitch.OFF</p>
</li>
<li>
<p>Flow contains a connector­datamapper­connector building block arrangement that is on the canvas.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Steps</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Expected result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configure both connectors with the same operation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Metadata is fetched for both configurations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select the DataMapper building block.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check the Input panel.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No values display.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check the Output panel.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No values display.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_datasense_query_editor_dsql">DataSense Query Editor / DSQL</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Connectors QA scope limits to check if feature reflects connector specific configuration values.
As example use the Dynamics connector (MessageProcessor expects XML thus everything is overridden).</p>
</div>
<div class="sect2">
<h3 id="_datasense_query_editor_oauth_connector_only_nql_query_option_available">DataSense Query Editor - OAuth Connector - Only NQL Query Option Available</h3>
<div class="sect3">
<h4 id="_preconditions_18">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Flow contains a connector building block that is on the canvas and its Global Configuration element was selected as Config Reference.</p>
</li>
<li>
<p><strong>Step 1:</strong> Select corresponding operation for message processor with attribute marked @Query.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

* For attribute marked @Query only Native Query Language option in dropdown displays.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-16.png" alt="qa guidelines 16">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre>* Return type dropdown does not display.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_datasense_query_editor_non_oauth_connector_dsql_and_nql_query_options_available">DataSense Query Editor - Non-OAuth Connector - DSQL and NQL Query Options Available</h3>
<div class="sect3">
<h4 id="_preconditions_19">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Flow contains a connector building block that is on the canvas and its Global Configuration element was selected as Config Reference.</p>
</li>
<li>
<p><strong>Step 1:</strong> Select corresponding operation for message processor with attribute marked @Query.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

* For attribute marked @Query *Native Query Language* and *DataSense Query Language* option in dropdown displays.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-17.png" alt="qa guidelines 17">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong> Click the Query Builder &#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Query Builder opens.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_datasense_query_editor_non_oauth_connector_query_by_nql">DataSense Query Editor - Non-OAuth connector - Query by NQL</h3>
<div class="sect3">
<h4 id="_preconditions_20">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Flow contains a connector building block that is on the canvas, and its config­element is already set.</p>
</li>
<li>
<p>A DataMapper building block has been placed next to the connector building block.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Steps</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Expected result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select corresponding operation for message processor with attribute marked @Query.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For attribute marked @Query Native Query Language and DataSense Query Language options are displayed in the Language dropdown.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select NQL as Language.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Check that Return type dropdown displays.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Make a Return type selection and then save.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Click the DataMapper element.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DataMapper is prepopulated according to Return type option selection (List&lt;Return type&gt;).</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_datasense_query_editor_non_oauth_connector_query_default_values">DataSense Query Editor - Non-OAuth Connector - @Query Default Values</h3>
<div class="sect3">
<h4 id="_preconditions_21">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Flow contains a connector building block that is on the canvas and its Global Configuration element was selected as Config Reference.</p>
</li>
<li>
<p>No parameters are passed to the @Query annotation.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Steps</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Expected result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select corresponding operation for message processor with attribute marked @Query and click on the Query Builder &#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Order By dropdown, Limit, and Offset fields are available.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build a query that applies two filters and makes use of the Order By, Limit, and Offset values.
Click <strong>OK</strong>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query Text is populated reflecting query values.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_datasense_query_editor_non_oauth_connector_query_builder_reflects_query_configuration">DataSense Query Editor - Non-OAuth Connector - Query Builder Reflects @Query Configuration</h3>
<div class="sect3">
<h4 id="_preconditions_22">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Flow contains a connector building block that is on the canvas and its Global Configuration element was selected as Config Reference.</p>
</li>
<li>
<p>Parameters are passed to the @Query annotation.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Steps</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Expected result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select corresponding operation for message processor with attribute marked @Query and click on the Query Builder &#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Order By dropdown, Limit, and Offset fields are available only if not passed as false to the annotation. Example:<br>
<code>@Query(limit = false, offset = false, orderBy = false)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build a query that applies two filters. Click OK.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query Text is populated. OR or AND operator is displayed between filters depending on configuration. Example:
<code>@Query(disabledOperators = QueryOperator.OR)</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_datasense_query_editor_non_oauth_connector_query_builder_reflects_service_metadata_configuration">DataSense Query Editor - Non-OAuth connector - Query builder reflects service metadata configuration</h3>
<div class="paragraph">
<p><strong>@MetaDataKeyRetriever</strong> and <strong>@MetaDataRetriever</strong> annotated methods sets service specific configuration for Query Builder.
By default a Field "query configuration" (isWhereCapable, isSelectCapable, isOrderByCapable) are all true unless overridden by the service metadata.
Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// sObject isFromCapable (available in Types)</span>
<span class="comment">// public DefaultMetaDataKey(java.lang.String id, java.lang.String displayName, boolean isFromCapable);</span>
<span class="keyword">new</span> DefaultMetaDataKey(sobject.getName(), sobject.getLabel(), sobject.isQueryable())
<span class="comment">// sObject attribute available in Fields and appears on the Filter dropdown depending on the service.</span>
dynamicObject.addSimpleField(field.getName(), dataType).isWhereCapable(field.isFilterable());
<span class="comment">// sObject attribute available in Fields and appears on the Order By dropdown depending on the service.</span>
dynamicObject.addSimpleField(field.getName(), dataType).isOrderByCapable(f.isSortable());</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_preconditions_23">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Flow contains a connector building block that is on the canvas and its Global Configuration element was selected as Config Reference.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_15">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Select corresponding operation for message processor with attribute marked @Query and click on the <strong>Query Builder &#8230;&#8203;</strong></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Query Builder opens.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong> From service documentation derive equivalence classes such:</p>
</li>
<li>
<p>Types not from­capable.</p>
</li>
<li>
<p>Fields not filterable.</p>
</li>
<li>
<p>Fields not sortable.</p>
</li>
<li>
<p>Fields not selectable.</p>
</li>
<li>
<p>&#8230;&#8203;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Select a representative value for each class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Object Builder reflects values.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dsql_non_oauth_connector_query_translation">DSQL - Non-OAuth Connector - Query Translation</h3>
<div class="paragraph">
<p>Method annotated as @QueryTranslator contains logic to translate DSQL queries into NQL in case clauses or operators do not match those predefined by DSQL.<br>
Visitor classes (can be recognized by the extends DefaultQueryVisitor extends DefaultOperatorVisitor) that handle the mapping from a DSQL query into the service Native Query Language.<br>
SELECT, WHERE, OPERATORS and ORDERBY values can be overridden.</p>
</div>
<div class="sect3">
<h4 id="_preconditions_24">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Flow contains a connector building block that is on the canvas and its Global Configuration element was selected as Config Reference.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Steps</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Expected result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select corresponding operation for message processor with attribute marked @Query and click on the Query Builder &#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query Builder is displayed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build queries using query builder that make use of clauses and operators whose values are been overridden by the connector.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query Text is populated in DSQL format.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change from DSQL to NQL and check that the translation has been made correctly.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clauses and operators and correctly translated.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_dsql_non_oauth_connector_query_equivalence">DSQL - Non-OAuth Connector - Query Equivalence</h3>
<div class="sect3">
<h4 id="_preconditions_25">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Flow contains a connector building block that is on the canvas and its Global Configuration element was selected as Config Reference.</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 10%;">
<col style="width: 45%;">
<col style="width: 45%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Steps</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Expected result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select corresponding operation for message processor with attribute marked @Query and click the Query Builder &#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query Builder is displayed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build a query using query builder that make use of clauses and operators whose values are been overridden by the connector.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query Text is populated in DSQL format.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Run the Mule application. Then Hit the endpoint to retrieve results.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Take note of the query results</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stop the application.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Change from DSQL to NQL and check that the translation has been made correctly.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clauses and operators and correctly translated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Run the Mule application. Then Hit the endpoint to retrieve results.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Query results are the same than the ones on the DSQL query.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_auto_paging">Auto-Paging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Connector supports Auto­Paging if a least one of its operations is annotated as @Paged and returns a PagingDelegate. The following test cases apply to Non­query, DSQL and NQL operations.</p>
</div>
<div class="sect2">
<h3 id="_auto_paging_fetch_size_parameter">Auto-Paging - Fetch Size Parameter</h3>
<div class="sect3">
<h4 id="_preconditions_26">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Flow contains a connector building block that is on the canvas and its Global Configuration element was selected as Config Reference.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_16">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Select an operation whose return type is PagingDelegate&lt;SomeEntity&gt;.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Paging section containing a Fetch Size input field is displayed in the General tab of the connector view.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-18.png" alt="qa guidelines 18">
</div>
</div>
<div class="paragraph">
<p>Fetch Size value is 100 by default.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong> Enter a Fetch Size value other than 100. Save and change to the Configuration XML view.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">Expected Result:

fetchSize attribute is on the operation XML.
<span class="tag">&lt;google-contacts:get-contacts</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Google_Contacts</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Google Contacts</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">fetchSize</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">30</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_auto_paging_empty_collection">Auto-Paging - Empty Collection</h3>
<div class="paragraph">
<p>====￼Preconditions</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Global Configuration element was already crea</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_steps_17">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Arrange a flow as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop the desired connector in the flow.</p>
</li>
<li>
<p>Next to the connector place a For Each scope.</p>
</li>
<li>
<p>Inside the For Each place a Logger element.</p>
</li>
<li>
<p>After the For Each place a Set Payload element.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Flow arrangement looks similar to this:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-19.png" alt="qa guidelines 19">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the connector, select an operation whose return type is PagingDelegate&lt;SomeEntity&gt;.</p>
</li>
<li>
<p>Set parameter values such as no records are returned by the operation.</p>
</li>
<li>
<p>Click Save.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Metadata is fetched for the selected operation.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong> Set "For element #[flowVars['counter']] payload is #[message.payload]" as the Logger message value. Then click Save.</p>
</li>
<li>
<p><strong>Step 4:</strong> Set "Done." as the Set Payload element Value. Then Click Save.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Example of a complete flow result:

&lt;flow name="features-autopaging-certFlow1"
doc:name="features-autopaging-certFlow1"&gt;
  	&lt;http:inbound-endpoint exchange-pattern="request-response"
	host="localhost" port="8081" doc:name="HTTP" path="contacts"/&gt;

  	&lt;google-contacts:authorize config-ref="Google_Contacts"
	doc:name="Authorize"/&gt;

  	&lt;google-contacts:get-contacts config-ref="Google_Contacts" doc:name="Get contacts" updatedMax="2000-09-29T18:46:19-0700" datetimeFormat="yyyy-MM-dd'T'HH:mm:ssZ"/&gt;

   	&lt;foreach doc:name="For Each"&gt;
  	   &lt;logger message="For element #[flowVars['counter']] payload is #[message.payload]" level="INFO" doc:name="Logger"/&gt;
	&lt;/foreach&gt;

   &lt;set-payload value="Done." doc:name="SetPayload"/&gt;
&lt;/flow&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 5:</strong> Run the app and hit the flow endpoint. Check the console afterwards.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

org.mule.routing.Foreach$CollectionMapSplitter: Splitter returns no results. If this is not expected, check your split expression.
Logs to the console.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_auto_paging_abort_iteration">Auto-Paging - Abort Iteration</h3>
<div class="paragraph">
<p>Verify that after processing current element, iteration is terminated.
====￼Preconditions</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Global Configuration element has been created with valid credentials to the service.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_steps_18">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Arrange a flow as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop the desired connector in the flow.</p>
</li>
<li>
<p>Next to the connector, place the Logger element.</p>
</li>
<li>
<p>Next to the Logger put a For Each scope.</p>
</li>
<li>
<p>Inside the For Each, place a Logger, a DataMapper, and another Logger.</p>
</li>
<li>
<p>Following the For Each, place a Set Payload element.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Flow arrangement looks similar to this:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-20.png" alt="qa guidelines 20">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the connector select an operation whose return type is
PagingDelegate&lt;SomeEntity&gt;.</p>
</li>
<li>
<p>Open Query Builder and generate a simple
query such as: SELECT CreatedById,CreatedDate,Description, OwnerId FROM Account LIMIT 3.</p>
</li>
<li>
<p>Set a fetchSize value of 1 or lower than the amount the amount of records been returned.</p>
</li>
<li>
<p>Click Save.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Metadata fetches for the selected operation.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong>  Set "<mark>#</mark> Total amount of elements retrieved is
#[message.payload.size()]" as the first
Logger message value. Then click Save.</p>
</li>
<li>
<p><strong>Step 4:</strong> Select the For Each and set rootMessage as its "Root Message Variable Name". Then click Save.</p>
</li>
<li>
<p><strong>Step 5:</strong> Set "Closing the iterator: #[flowVars['rootMessage'].getPayload ().close()]" as the message value for the first Logger within the For Each. Then click Save.</p>
</li>
<li>
<p><strong>Step 6:</strong>  On the DataMapper element, create a mapping to a Default <code>Map&lt;k,v&gt;</code> object.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mapping creates.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 7:</strong> Set "For element #[flowVars['counter']] payload is #[message.payload]" as the Logger message value. Then click Save.</p>
</li>
<li>
<p><strong>Step 8:</strong> Set "Done." as the Set payload element Value. Then click Save.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">Example of a complete result flow:

<span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">features-autopaging-salesforceFlow1</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">features-autopaging-salesforceFlow1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;http:inbound-endpoint</span> <span class="attribute-name">exchange-pattern</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">request-response</span><span class="delimiter">&quot;</span></span>
         <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">8081</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">apforeach</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

         <span class="tag">&lt;sfdc:query</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">query</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">dsql:SELECT CreatedById,CreatedDate,Description,OwnerId FROM Account LIMIT 3</span><span class="delimiter">&quot;</span></span>
         <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Query</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">fetchSize</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

        <span class="tag">&lt;logger</span> <span class="attribute-name">message</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">### Total amount of elements retrieved is #[payload.size()]</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Size</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

        <span class="tag">&lt;foreach</span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">For Each</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
           <span class="tag">&lt;data-mapper:transform</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">account_to_map</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Account To Map</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
           <span class="tag">&lt;logger</span> <span class="attribute-name">message</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">For element #[flowVars['counter']]  payload is</span>
                <span class="content">#[message.payload]</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Records</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/foreach&gt;</span>

        <span class="tag">&lt;set-payload</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Done.</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Set Payload</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 10:</strong>  Run the app and hit the flow endpoint.</p>
</li>
<li>
<p><strong>Step 11:</strong>  Look for the messages logged by the Records Logger on the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Only a message for the first record logs.</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_non_query_operations">Non-Query Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As example, use Google Contacts connectors.</p>
</div>
<div class="sect2">
<h3 id="_auto_paging_non_query_operation_auto_paged_output_handling_datamapper">Auto-Paging - Non-Query Operation - Auto-Paged Output Handling - DataMapper</h3>
<div class="paragraph">
<p>PagingDelegate is typed thus it&#8217;s expected to work together with DataMapper.
====￼Preconditions</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Global Configuration element was already created with valid credentials to the service.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_steps_19">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Arrange a flow as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop the desired connector in the flow.</p>
</li>
<li>
<p>Next to the connector, place a DataMapper element.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-21.png" alt="qa guidelines 21">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong> On the connector, select an operation whose return type is PagingDelegate&lt;SomeEntity&gt;. Then click Save.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Metadata fetches for the selected operation.w</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong>
Click the DataMapper element.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mule automatically prescribes the output of the operation as List&lt;SomeEntity&gt;. The type is in the connector code, for example: `List&lt;GoogleContactEntry&gt;`
for an operation returns: `PagingDelegate&lt;GoogleContactEntry&gt;`</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong> In the Output Panel select:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Type: Map&lt;k,v&gt;</p>
</li>
<li>
<p>Click User Defined</p>
</li>
<li>
<p>Click Generate default</p>
</li>
<li>
<p>Click Create mapping</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mapping creates.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_auto_paging_non_query_operation_auto_paged_output_handling_foreach_combined_with_datamapper">Auto-Paging - Non-Query Operation - Auto-Paged Output Handling - Foreach Combined with DataMapper</h3>
<div class="sect3">
<h4 id="_preconditions_27">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global Configuration element was already created with valid credentials to the service.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_20">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Arrange a flow as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop the desired connector in the flow.</p>
</li>
<li>
<p>Next to the connector, place a For Each scope.</p>
</li>
<li>
<p>Inside the For Each, place a DataMapper element.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-22.png" alt="qa guidelines 22">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong> On the connector, select an operation whose return type is PagingDelegate&lt;SomeEntity&gt;. Then click Save.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Metadata fetches for the selected operation.w</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong>
Click the DataMapper element.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mule automatically prescribes the output of the operation as `SomeEntity`.
The type is in the connector code, for example: `GoogleContactEntry` for an operation returns: `PagingDelegate&lt;GoogleContactEntry&gt;`</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong> In the Output Panel select:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Type: Map&lt;k,v&gt;</p>
</li>
<li>
<p>Click User Defined</p>
</li>
<li>
<p>Click Generate default</p>
</li>
<li>
<p>Click Create mapping</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mapping creates.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_auto_paging_non_query_operation_pagination_is_applied">Auto-Paging - Non-Query Operation - Pagination is Applied</h3>
<div class="sect3">
<h4 id="_preconditions_28">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global Configuration element was already created with valid credentials to the service.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_21">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Arrange a flow as follows::</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop the desired connector in the flow.</p>
</li>
<li>
<p>Next to the connector place Logger element.</p>
</li>
<li>
<p>Next to the Logger put a For each element.</p>
</li>
<li>
<p>Inside the For each place a DataMapper and then a Logger next to it.</p>
</li>
<li>
<p>After the For Each place a Set payload element.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result

Flow arrangement looks similar to this:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-23.png" alt="qa guidelines 23">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the connector, select an operation whose return type is PagingDelegate&lt;SomeEntity&gt;.</p>
</li>
<li>
<p>Set a fetchSize value of 1 or lower than the amount of records that&#8217;s going to be retrieved.</p>
</li>
<li>
<p>Click Save.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Metadata fetches for the selected operation.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong> Set "<mark>#</mark> Total amount of elements retrieved is
#[message.payload.size()]" as the
Logger message value. Then click Save.</p>
</li>
<li>
<p><strong>Step 4:</strong> On the DataMapper element, create a mapping to a Default Map&lt;k,v&gt; object.
Mapping creates.</p>
</li>
<li>
<p><strong>Step 5:</strong> Set "For element #[flowVars['counter']] payload is #[message.payload]" as the Logger message value. Then click Save.</p>
</li>
<li>
<p><strong>Step 6:</strong> Set "Done." as the Set Payload element Value. Then click Save.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">Example of a complete flow:

<span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">features-autopaging-datamapper-complianceFlow3</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">features-autopaging-datamapper-compl</span>
<span class="content">ianceFlow3</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;http:inbound-endpoint</span> <span class="attribute-name">exchange-pattern</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">request-response</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">8081</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreachdm</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

          <span class="tag">&lt;google-contacts:authorize</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Google_Contacts</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Authorize</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

          <span class="tag">&lt;google-contacts:get-groups</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Google_Contacts</span><span class="delimiter">&quot;</span></span>
          <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Get groups</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

          <span class="tag">&lt;logger</span> <span class="attribute-name">message</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">### Total amount of elements retrieved is</span>
        <span class="content">#[message.payload.size()]</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Size</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

          <span class="tag">&lt;foreach</span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">For Each</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;data-mapper:transform</span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">DataMapper</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
            <span class="tag">&lt;logger</span> <span class="attribute-name">message</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">For element #[flowVars['counter']] payload is</span>
                <span class="content">#[message.payload]</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Records</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/foreach&gt;</span>

          <span class="tag">&lt;set-payload</span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Set Payload</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Done.</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 7:</strong> Run the app and hit the flow endpoint.</p>
</li>
<li>
<p><strong>Step 8:</strong> Look for the messages logged by the Records Logger on the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

For each record a "For element ... " message was logged displaying its payload.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 9:</strong> Look for the message of the Size Logger on the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Amount of elements retrieved equals number of records returned.

Note: You can override the getTotalResults() method in the connector in case of service constraints.For this case, a value of ­1 is returns if the size can't be provided.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_auto_paging_non_query_operation_pagination_is_not_applied">Auto-Paging - Non-Query Operation - Pagination is Not Applied</h3>
<div class="sect3">
<h4 id="_preconditions_29">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global Configuration element was already created with valid credentials to the service.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_22">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Arrange a flow as follows::</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop the desired connector in the flow.</p>
</li>
<li>
<p>Next to the connector, place a Logger element.</p>
</li>
<li>
<p>Next to the Logger, place a For Each scope.</p>
</li>
<li>
<p>Inside the For Each, place a DataMapper and then a Logger next to it.</p>
</li>
<li>
<p>After the For Each, place a Set Payload element.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Flow arrangement looks similar to this:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-24.png" alt="qa guidelines 24">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the connector, select an operation whose return type is PagingDelegate&lt;SomeEntity&gt;.</p>
</li>
<li>
<p>Set a fetchSize higher than amount of existing records.</p>
</li>
<li>
<p>Click Save.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Metadata fetches for the selected operation.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong>  Set "<mark>#</mark> Total amount of elements retrieved is
#[message.payload.size()]" as the
Logger message value. Then click Save.</p>
</li>
<li>
<p><strong>Step 4:</strong> On the DataMapper element, create a mapping to a Default Map&lt;k,v&gt; object.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mapping is created.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 5:</strong> Set "For element #[flowVars['counter']] payload is #[message.payload]" as the Logger message value. Then Click Save.</p>
</li>
<li>
<p><strong>Step 6:</strong>  Set "Done." as the Set Payload element Value. Then Click Save.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">Example of a complete flow:

<span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">features-autopaging-datamapper-complianc</span>
<span class="content">eFlow3</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">features-autopaging-datamapper-compl</span>
<span class="content">ianceFlow3</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          <span class="tag">&lt;http:inbound-endpoint</span>
        <span class="attribute-name">exchange-pattern</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">request-response</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">8081</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">foreachdm</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

          <span class="tag">&lt;google-contacts:authorize</span>
        <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Google_Contacts</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Authorize</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

          <span class="tag">&lt;google-contacts:get-groups</span>
        <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Google_Contacts</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Get</span>
        <span class="content">groups</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

          <span class="tag">&lt;logger</span> <span class="attribute-name">message</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">### Total amount of</span>
        <span class="content">elements retrieved is</span>
        <span class="content">#[message.payload.size()]</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Size</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

        <span class="tag">&lt;foreach</span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">For Each</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
                    <span class="tag">&lt;data-mapper:transform</span>
                        <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">DataMapper</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
                    <span class="tag">&lt;logger</span> <span class="attribute-name">message</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">For element</span>
                        <span class="content">#[flowVars['counter']]  payload is</span>
                        <span class="content">#[message.payload]</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Records</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/foreach&gt;</span>
          <span class="tag">&lt;set-payload</span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Set Payload</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Done.</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 7:</strong> Look for the messages logged by the Records Logger on the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

For each record a "For element ... " message was logged displaying its payload.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 8:</strong>  Look for the message of the Size Logger on the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Amount of elements retrieved equals number of records returned.

Note: You can override the getTotalResults() method in the connector in case of service constraints.For this case, a value of ­1 is returns if size can't be provided.</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_auto_paging_dsql_interoperability">Auto-Paging DSQL Interoperability</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An example that uses the Salesforce/NetSuite connectors.</p>
</div>
<div class="sect2">
<h3 id="_datasense_query_language">DataSense Query Language</h3>

</div>
<div class="sect2">
<h3 id="_auto_paging_dsql_auto_paged_output_handling_datamapper">Auto-Paging - DSQL - Auto-Paged Output Handling - DataMapper</h3>
<div class="sect3">
<h4 id="_preconditions_30">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global Configuration Element was already created with valid credentials to the service.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_23">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Arrange a flow as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop the desired connector in the flow.</p>
</li>
<li>
<p>Next to the connector, place a DataMapper element.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-25.png" alt="qa guidelines 25">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the connector select an operation whose return type is PagingDelegate&lt;SomeEntity&gt; and has one of its parameters annotated with @Query.</p>
</li>
<li>
<p>Select DataSense Query Language as Language.</p>
</li>
<li>
<p>Using Object Builder create a simple query involving a couple of fields, for example: SELECT AccountSource,BillingCity,BillingLon gitude,CreatedDate FROM Account.</p>
</li>
<li>
<p>Click Save.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Metadata is fetched for the selected operation.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong> Click on the DataMapper element.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mule automatically prescribes the output of the operation as List&lt;SomeEntity&gt;. The type is in the connector code, for example: PagingDelegate&lt;Map&lt;String, Object&gt;&gt;
for an operation returns: PagingDelegate&lt;Map&lt;String, Object&gt;&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong> In the Output Pane select:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Type: Map&lt;k,v&gt;</p>
</li>
<li>
<p>Click User Defined</p>
</li>
<li>
<p>Click Generate default</p>
</li>
<li>
<p>Click Create mapping</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mapping involving only the fields been queried is created.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-26.png" alt="qa guidelines 26">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_auto_paging_dsql_auto_paged_output_handling_foreach_combined_with_datamapper">Auto-Paging - DSQL - Auto-Paged Output Handling - Foreach Combined with DataMapper</h3>
<div class="sect3">
<h4 id="_preconditions_31">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global Configuration element was already created with valid credentials to the service.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_24">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Arrange a flow as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop the desired connector in the flow.</p>
</li>
<li>
<p>Next to the connector, place a For Each scope.</p>
</li>
<li>
<p>Inside the For each place a DataMapper element.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-27.png" alt="qa guidelines 27">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the connector select an operation whose return type is
PagingDelegate&lt;SomeEntity&gt; and has one of its parameters annotated with @Query.</p>
</li>
<li>
<p>Select DataSense Query Language as Language.</p>
</li>
<li>
<p>Using Object Builder create a simple query involving a couple of fields, for example: SELECT AccountSource,BillingCity,BillingLon gitude,CreatedDate FROM Account</p>
</li>
<li>
<p>Click Save.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Metadata fetches for the selected operation.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong> Click the DataMapper element.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mule automatically prescribes the output of the operation as List&lt;SomeEntity&gt;. The type is in the connector code, for example: PagingDelegate&lt;Map&lt;String, Object&gt;&gt;
for an operation returns: PagingDelegate&lt;Map&lt;String, Object&gt;&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong> In the Output Pane select:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Type: Map&lt;k,v&gt;</p>
</li>
<li>
<p>Click User Defined</p>
</li>
<li>
<p>Click Generate default</p>
</li>
<li>
<p>Click Create mapping</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mapping involving only the fields being queried is created.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-28.png" alt="qa guidelines 28">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_auto_paging_dsql_pagination_is_applied">Auto-Paging - DSQL - Pagination is Applied</h3>
<div class="sect3">
<h4 id="_preconditions_32">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global Configuration element was already created with valid credentials to the service.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_25">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Arrange a flow as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop the desired connector in the flow.</p>
</li>
<li>
<p>Next to the connector place Logger element.</p>
</li>
<li>
<p>Next to the Logger put a For Each scope.</p>
</li>
<li>
<p>Inside the For Each place a DataMapper and then a Logger next to it.</p>
</li>
<li>
<p>After the For Each, place a Set Payload element.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Flow arrangement looks similar to this:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-29.png" alt="qa guidelines 29">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the connector, select an operation whose return type is PagingDelegate&lt;SomeEntity&gt;.</p>
</li>
<li>
<p>Open Query Builder and generate a simple query such as: SELECT. CreatedById,CreatedDate,Descripti on,OwnerId FROM Account LIMIT 3</p>
</li>
<li>
<p>Set a fetchSize value of 1 or lower than the amount of records being returned.</p>
</li>
<li>
<p>Click Save.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:
￼
Metadata fetches for the selected operation.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set "<mark>#</mark> Total amount of elements retrieved is
#[message.payload.size()]" as the
Logger message value. Then Click Save.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Step 4:</strong> On the DataMapper element creating a mapping to a Default Map&lt;k,v&gt; object.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mapping creates.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 5:</strong> Set "For element #[flowVars['counter']] payload is #[message.payload]" as the Logger message value. Then Click Save.</p>
</li>
<li>
<p><strong>Step 6:</strong> Set "Done." as the Set Payload element Value. Then Click Save.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Example of a complete flow:

&lt;flow name="features-autopaging-salesforceFlow1"
doc:name="features-autopaging-salesforceFlow1"&gt;
    &lt;http:inbound-endpoint
	exchange-pattern="request-response"
	host="localhost" port="8081" path="apforeach"
	doc:name="HTTP"/&gt;

    &lt;sfdc:query config-ref="Salesforce"
	query="dsql:SELECT
	CreatedById,CreatedDate,Description,OwnerId
	FROM Account LIMIT 3" doc:name="Query"
	fetchSize="2"/&gt;

    &lt;logger message="### Total amount of
	elements retrieved is
	#[message.payload.size()]" level="INFO"
	doc:name="Size"/&gt;

    &lt;foreach doc:name="For Each"&gt;
        &lt;data-mapper:transform
		config-ref="account_to_map" doc:name="Account
		To Map"/&gt;

        &lt;logger message="For element
		#[flowVars['counter']]  payload is
		#[message.payload]" doc:name="Records"/&gt;
    &lt;/foreach&gt;

    &lt;set-payload value="Done." doc:name="Set Payload"/&gt;
&lt;/flow&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 7:</strong> Run the app and hit the flow endpoint.</p>
</li>
<li>
<p><strong>Step 8:</strong> Look for the messages logged by the Records Logger on the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

For each record a "For element ... " message was logged displaying its payload.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 9:</strong>  Look for the message of the Size Logger on the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Amount of elements retrieved equals number of records returned.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_auto_paging_dsql_pagination_is_not_applied">Auto-Paging - DSQL - Pagination is Not Applied</h3>
<div class="sect3">
<h4 id="_preconditions_33">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global Configuration element was already created with valid credentials to the service.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_steps_26">Steps</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Step 1:</strong> Arrange a flow as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop the desired connector in the flow.</p>
</li>
<li>
<p>Next to the connector, place Logger element.</p>
</li>
<li>
<p>Next to the Logger, place a For Each scope.</p>
</li>
<li>
<p>Inside the For Each, place a DataMapper
and then a Logger next to it.</p>
</li>
<li>
<p>After the For Each, place a Set Payload
element.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Flow arrangement looks similar to this:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-30.png" alt="qa guidelines 30">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the connector, select an operation whose return type is
PagingDelegate&lt;SomeEntity&gt;.</p>
</li>
<li>
<p>Open Query Builder and generate a simple
query such as: SELECT CreatedById,CreatedDate,Description, OwnerId FROM Account LIMIT 1</p>
</li>
<li>
<p>Set a fetchSize value higher than the amount of records being returned.</p>
</li>
<li>
<p>Click Save.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Metadata is fetched for the selected operation.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong> Set "<mark>#</mark> Total amount of elements retrieved is
#[message.payload.size()]" as the
Logger message value. Then Click Save.</p>
</li>
<li>
<p><strong>Step 4:</strong> On the DataMapper element create a mapping to a Default Map&lt;k,v&gt; object.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mapping creates.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 5:</strong> Set "For element #[flowVars['counter']] payload is #[message.payload]" as the Logger message value. Then Click Save.</p>
</li>
<li>
<p><strong>Step 6:</strong> Set "Done." as the Set Payload element Value. Then Click Save.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Example of a complete flow:

&lt;flow name="features-autopaging-salesforceFlow1"
doc:name="features-autopaging-salesforceFlow1"&gt;
  	&lt;http:inbound-endpoint
	exchange-pattern="request-response"
	host="localhost" port="8081" path="apforeach"
	doc:name="HTTP"/&gt;

   	&lt;sfdc:query config-ref="Salesforce"
	query="dsql:SELECT
	CreatedById,CreatedDate,Description,OwnerId
	FROM Account LIMIT 3" doc:name="Query"
	fetchSize="2"/&gt;

   	&lt;logger message="### Total amount of
	elements retrieved is
	#[message.payload.size()]" level="INFO"
	doc:name="Size"/&gt;

   &lt;foreach doc:name="For Each"&gt;
     	&lt;data-mapper:transform
		config-ref="account_to_map" doc:name="Account To Map"/&gt;

    	&lt;logger message="For element
		#[flowVars['counter']]  payload is
		#[message.payload]" doc:name="Records"/&gt;
	&lt;/foreach&gt;

	&lt;set-payload value="Done." doc:name="Set
	Payload"/&gt;
&lt;/flow&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 7:</strong> Run the app and hit the flow endpoint.</p>
</li>
<li>
<p><strong>Step 8:</strong> Look for the messages logged by the Records Logger on the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

For each record a "For element ... " message was logged displaying its payload.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 9:</strong> Look for the message of the Size Logger on the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Amount of elements retrieved equals number of records returned.
Note: You can override the getTotalResults() method in the connector in case of service constraints.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_native_query_language">Native Query Language</h3>

</div>
<div class="sect2">
<h3 id="_auto_paging_nql_auto_paged_output_handling_datamapper">Auto-Paging - NQL - Auto-Paged Output Handling - DataMapper</h3>
<div class="sect3">
<h4 id="_preconditions_34">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global Configuration element was already created with valid credentials to the service.</p>
</li>
<li>
<p><strong>Step 1:</strong> Arrange a flow as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop the desired connector in the flow.</p>
</li>
<li>
<p>Next to the connector, place a DataMapper element.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-31.png" alt="qa guidelines 31">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the connector select an operation whose return type is PagingDelegate&lt;SomeEntity&gt; and has one of its parameters annotated with @Query.</p>
</li>
<li>
<p>Select Native Query Language as Language.</p>
</li>
<li>
<p>Enter a simple query as Query Text: SELECT
AccountSource,BillingCity,BillingLon
gitude,CreatedDate FROM Account</p>
</li>
<li>
<p>As Return type select the same Object as stated in the FROM field of the query.</p>
</li>
<li>
<p>Click Save.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Metadata is fetched for the selected operation.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong>
Click the DataMapper element.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mule automatically prescribes the output of the operation as List&lt;SomeEntity&gt;. The type is in the connector code, for example: PagingDelegate&lt;Map&lt;String, Object&gt;&gt; for an operation returns: PagingDelegate&lt;Map&lt;String, Object&gt;&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong> In the Output Pane select:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Type: Map&lt;k,v&gt;</p>
</li>
<li>
<p>Click User Defined</p>
</li>
<li>
<p>Click Generate default</p>
</li>
<li>
<p>Click Create mapping</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mapping involving only the fields been queried is created.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-32.png" alt="qa guidelines 32">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_auto_paging_nql_auto_paged_output_handling_foreach_combined_with_datamapper">Auto-Paging - NQL - Auto-Paged Output Handling - Foreach Combined with DataMapper</h3>
<div class="sect3">
<h4 id="_preconditions_35">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global Configuration element was already created with valid credentials to the service.</p>
</li>
<li>
<p><strong>Step 1:</strong> Arrange a flow as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop the desired connector in the flow.</p>
</li>
<li>
<p>Next to the connector, place a For Each element.</p>
</li>
<li>
<p>Inside the For Each place a DataMapper element.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Step 2:</strong> On the connector select an operation whose return type is PagingDelegate&lt;SomeEntity&gt; and has one of its parameters annotated with @Query.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select Native Query Language as Language.</p>
</li>
<li>
<p>Enter a simple query as Query Text: SELECT
AccountSource,BillingCity,BillingLon
gitude,CreatedDate FROM Account</p>
</li>
<li>
<p>As Return type, select the same Object as stated in the FROM field of the query.</p>
</li>
<li>
<p>Click Save.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Metadata is fetched for the selected operation.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong>  Click the DataMapper element.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mule automatically prescribes the output of the operation as List&lt;SomeEntity&gt;. The type is in the connector code, for example: PagingDelegate&lt;Map&lt;String, Object&gt;&gt;
for an operation returns: PagingDelegate&lt;Map&lt;String, Object&gt;&gt;</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 4:</strong>  In the Output Pane select:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Type: Map&lt;k,v&gt;</p>
</li>
<li>
<p>Click User Defined</p>
</li>
<li>
<p>Click Generate default</p>
</li>
<li>
<p>Click Create mapping</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mapping involving only the fields been queried is created.</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-33.png" alt="qa guidelines 33">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_auto_paging_nql_pagination_is_applied">Auto-Paging - NQL - Pagination is Applied</h3>
<div class="sect3">
<h4 id="_preconditions_36">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global Configuration element was already created with valid credentials to the service.</p>
</li>
<li>
<p><strong>Step 1:</strong>  Arrange a flow as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop the desired connector in the flow.</p>
</li>
<li>
<p>Next to the connector, place a Logger element.</p>
</li>
<li>
<p>Next to the Logger, place a For Each element.</p>
</li>
<li>
<p>Inside the For Each, place a DataMapper and then a Logger next to it.</p>
</li>
<li>
<p>After the For Each, place a Set Payload element.
￼</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Flow arrangement looks similar to this:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-34.png" alt="qa guidelines 34">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the connector select an operation whose return type is PagingDelegate&lt;SomeEntity&gt;.</p>
</li>
<li>
<p>Select Native Query Language as Language.</p>
</li>
<li>
<p>Enter a simple query as Query Text: SELECT
AccountSource,BillingCity,BillingLon
gitude,CreatedDate FROM Account</p>
</li>
<li>
<p>As Return type select the same Object as stated in the FROM field of the query.</p>
</li>
<li>
<p>Set a fetchSize value of 1 or lower than the amount the amount of records been returned.</p>
</li>
<li>
<p>Click Save.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Metadata is fetched for the selected operation.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 3:</strong> Set "<mark>#</mark> Total amount of elements retrieved is
#[message.payload.size()]" as the
Logger message value. Then Click Save.</p>
</li>
<li>
<p><strong>Step 4:</strong>  On the DataMapper element creating a mapping to a Default Map&lt;k,v&gt; object.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mapping is created.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 5:</strong> Set "For element #[flowVars['counter']] payload is #[message.payload]" as the Logger message value. Then Click Save.</p>
</li>
<li>
<p><strong>Step 6:</strong> Set "Done." as the Set Payload element Value. Then Click Save.</p>
</li>
<li>
<p><strong>Step 7:</strong> Run the app and hit the flow endpoint.</p>
</li>
<li>
<p><strong>Step 8:</strong>   Look for the messages logged by the Records Logger on the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

For each record a "For element ... " message was logged displaying its payload.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 9:</strong> Look for the message of the Size Logger on the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Amount of elements retrieved equals number of records returned.</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_auto_paging_nql_pagination_is_not_applied">Auto-Paging - NQL - Pagination is Not Applied</h3>
<div class="sect3">
<h4 id="_preconditions_37">Preconditions</h4>
<div class="ulist">
<ul>
<li>
<p>Global Configuration element was already created with valid credentials to the service.</p>
</li>
<li>
<p><strong>Step 1:</strong> Arrange a flow as follows:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Place an HTTP endpoint on the canvas.</p>
</li>
<li>
<p>Drop the desired connector in the flow.</p>
</li>
<li>
<p>Next to the connector, place a Logger element.</p>
</li>
<li>
<p>Next to the Logger, place a For Each element.</p>
</li>
<li>
<p>Inside the For Each, place a DataMapper and then a Logger next to it.</p>
</li>
<li>
<p>After the For Each, place a Set Payload element.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Flow arrangement looks similar to this:</pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-35.png" alt="qa guidelines 35">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 2:</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the connector, select an operation whose return type is PagingDelegate&lt;SomeEntity&gt;.
Metadata fetches for the selected operation.</p>
</li>
<li>
<p>Open Query Builder and generate a simple query such as: SELECT CreatedById,CreatedDate,Descripti on,OwnerId FROM Account LIMIT 1</p>
</li>
<li>
<p>Set a fetchSize value higher than the amount of records been returned.</p>
</li>
<li>
<p>Click Save.</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Step 3:</strong> Set "<mark>#</mark> Amount of elements retrieved is #[message.payload.size()]" as the
Logger message value. Then Click Save.</p>
</li>
<li>
<p><strong>Step 4:</strong>  On the DataMapper element creating a mapping to a Default Map&lt;k,v&gt; object.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Mapping creates.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 5:</strong> Set "For element #[flowVars['counter']] payload is #[message.payload]" as the Logger message value. Then Click Save.</p>
</li>
<li>
<p><strong>Step 6:</strong> Set "Done." as the Set Payload element Value. Then Click Save.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">Example of a complete flow:

<span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">features-autopaging-salesforceFlow3</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">features-autopaging-salesforceFlow3</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

          <span class="tag">&lt;http:inbound-endpoint</span>
        <span class="attribute-name">exchange-pattern</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">request-response</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">8081</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

          <span class="tag">&lt;sfdc:query</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">query</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT</span>
        <span class="content">AccountSource,BillingCity,BillingLongitude,CratedDate</span>
        <span class="content">FROM Account</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

        <span class="tag">&lt;logger</span> <span class="attribute-name">message</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">### Total amount of elements retrieved is</span>
        <span class="content">#[message.payload.size()]</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Size</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

          <span class="tag">&lt;foreach</span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">For Each</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;data-mapper:transform</span>
                <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">account_to_map_1</span><span class="delimiter">&quot;</span></span>
                <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Account To Map</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>

            <span class="tag">&lt;logger</span> <span class="attribute-name">message</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">For element</span>
                <span class="content">#[flowVars['counter']]  payload is</span>
                <span class="content">#[message.payload]</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Records</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;/foreach&gt;</span>
  <span class="tag">&lt;set-payload</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Done.</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Set Payload</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/flow&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 7:</strong> Run the app and hit the flow endpoint.</p>
</li>
<li>
<p><strong>Step 8:</strong> Look for the messages logged by the Records Logger on the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

For each record a "For element ... " message was logged displaying its payload.</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Step 9:</strong> Look for the message of the Size Logger on the console.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>Expected Result:

Amount of elements retrieved equals number of records returned.
Note: You can override the getTotalResults() method in the connector in case of service constraints.</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cloudhub_interoperability">CloudHub Interoperability</h2>
<div class="sectionbody">
<div class="paragraph">
<p>These items apply exclusively for connectors supporting OAuth authentication.</p>
</div>
<div class="paragraph">
<p>CloudHub&#8217;s Object Store is stateless (behaves like a proxy). This behavior is different from an Object Store in a local Mule application. For this reason, a simple application using OAuth must be run on the CloudHub platform to verify its correct behavior.</p>
</div>
<div class="paragraph">
<p>First, check that the callback URL on the application redirects to the URL set on the config­ref.</p>
</div>
<div class="paragraph">
<p>Make sure the domain on the Deploy to CloudHub dialog matches the one set for the callback URL.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="imageblock">
<div class="content">
<img src="assets/assets/qa-guidelines/qa-guidelines-37.png" alt="qa guidelines 37">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;facebook:config-with-oauth</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Facebook</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Facebook</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">consumerKey</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">206589772847469</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">consumerSecret</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">14b75847e7c9cca4159b3314b39fcd43</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;facebook:oauth-callback-config</span> <span class="attribute-name">domain</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">facebookoauth.stg.cloudhub.io</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">localPort</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${http.port}</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">callback</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/facebook:config-with-oauth&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Also make sure that the Mule version is the one under test.</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Facebook Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;mule</span> <span class="attribute-name">xmlns:json</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.mulesoft.org/schema/mule/json</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">xmlns:http</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.mulesoft.org/schema/mule/http</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">xmlns:facebook</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.mulesoft.org/schema/mule/facebook</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.mulesoft.org/schema/mule/core</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">xmlns:doc</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.mulesoft.org/schema/mule/documentation</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xmlns:spring</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.springframework.org/schema/beans</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">EE-3.5.0</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.springframework.org/schema/beans</span>
<span class="content">http://www.springframework.org/schema/beans/spring-beans-current.xsd</span>
<span class="content">http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd</span>
<span class="content">http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd</span>
<span class="content">http://www.mulesoft.org/schema/mule/facebook</span>
<span class="content">http://www.mulesoft.org/schema/mule/facebook/current/mule-facebook.xsd</span>
<span class="content">http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;facebook:config-with-oauth</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Facebook</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Facebook</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">consumerKey</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">206589772847469</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">consumerSecret</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">14b75847e7c9cca4159b3314b39fcd43</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;facebook:oauth-callback-config</span> <span class="attribute-name">domain</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">facebookoauth.stg.cloudhub.io</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">localPort</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${http.port}</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">callback</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/facebook:config-with-oauth&gt;</span>
    <span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.5.0-facebook-oauthFlow1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.5.0-facebook-oauthFlow1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;http:inbound-endpoint</span> <span class="attribute-name">exchange-pattern</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">request-response</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${http.port}</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">authFacebook</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;facebook:authorize</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Facebook</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Facebook</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;facebook:get-user</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Facebook</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Facebook</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">user</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hernan.wittemoller</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;json:object-to-json-transformer</span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Object to JSON</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/flow&gt;</span>
<span class="tag">&lt;/mule&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: remotePort should not be part of the config, and that the ${http.port} placeholder is to be used for ports.</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Salesforce Example</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generate keystore.jks running this command: <strong>keytool -genkey -alias mule -keyalg RSA -keystore keystore.jks</strong></p>
</li>
<li>
<p>Place keystore.jks it in src/resources.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;mule</span> <span class="attribute-name">xmlns:https</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.mulesoft.org/schema/mule/https</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xmlns:http</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.mulesoft.org/schema/mule/http</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">xmlns:sfdc</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.mulesoft.org/schema/mule/sfdc</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.mulesoft.org/schema/mule/core</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">xmlns:doc</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.mulesoft.org/schema/mule/documentation</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xmlns:spring</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.springframework.org/schema/beans</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">EE-3.5.0</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
       <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.mulesoft.org/schema/mule/https</span>
<span class="content">http://www.mulesoft.org/schema/mule/https/current/mule-https.xsd</span>
<span class="content">http://www.springframework.org/schema/beans</span>
<span class="content">http://www.springframework.org/schema/beans/spring-beans-current.xsd</span>
<span class="content">http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd</span>
<span class="content">http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd</span>
<span class="content">http://www.mulesoft.org/schema/mule/sfdc http://www.mulesoft.org/schema/mule/sfdc/current/mule-sfdc.xsd</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
￼￼38
<span class="tag">&lt;sfdc:config-with-oauth</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce__OAuth_</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">consumerKey</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3MVG9A2kN3Bn17huQMwGJWNHZUJ2eLycO_pQJMoGtGEUlVbGLkyO9EsUTEkTbf2ZnwyVhMiz0vSWvfVk7Ayws</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">consumerSecret</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">2313136062079803806</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce (OAuth)</span><span class="delimiter">&quot;</span></span> <span class="tag">&gt;</span>
        <span class="tag">&lt;sfdc:oauth-callback-config</span> <span class="attribute-name">domain</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">salesforceoauth.qa2.cloudhub.io</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">localPort</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${https.port}</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">oauthcallback</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">connector-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https_connector</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/sfdc:config-with-oauth&gt;</span>
    <span class="tag">&lt;https:connector</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https_connector</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">cookieSpec</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">netscape</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">validateConnections</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">sendBufferSize</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">receiveBufferSize</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">receiveBacklog</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">clientSoTimeout</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">10000</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">serverSoTimeout</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">10000</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">socketSoLinger</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP-HTTPS</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;https:tls-key-store</span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">keystore.jks</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">keyPassword</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">storePassword</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/https:connector&gt;</span>
    <span class="tag">&lt;flow</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.5.0-everest-oauth-salesforce-twoFlow1</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.5.0-everest-oauth-salesforce-twoFlow1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;http:inbound-endpoint</span> <span class="attribute-name">exchange-pattern</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">request-response</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">host</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">localhost</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">port</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${http.port}</span><span class="delimiter">&quot;</span></span>
<span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">HTTP</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">path</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">oauth</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;sfdc:authorize</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce__OAuth_</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">display</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">POPUP</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;sfdc:get-user-info</span> <span class="attribute-name">config-ref</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce__OAuth_</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Salesforce</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;logger</span> <span class="attribute-name">message</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">#[payload]</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">level</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">INFO</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Logger</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
        <span class="tag">&lt;set-payload</span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Done</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">doc:name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Set Payload</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;/flow&gt;</span>
<span class="tag">&lt;/mule&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_templates">Templates</h2>
<div class="sectionbody">
<div class="sect1">
<h2 id="_anypoint_connectors_documentation_template">Anypoint Connectors Documentation Template</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://github.com/mulesoft/connector-certification-docs/blob/docs/current/attachments/templates/documentationTemplate.adoc">Documentation Template</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_anypoint_connectors_release_notes_template">Anypoint Connectors Release Notes Template</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://github.com/mulesoft/connector-certification-docs/blob/docs/current/attachments/templates/releaseNotesTemplate.adoc">Release Notes Template</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_anypoint_connectors_manual_test_suite_template">Anypoint Connectors Manual Test Suite Template</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://docs.google.com/a/mulesoft.com/spreadsheets/d/1xqwGw5msku30sfjx6bpJDP9wZZ15cP2TcEzEq6pM9QM/edit?usp=sharing">Manual Test Suite Template</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_certification_checklist">Certification Checklist</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Download and complete the document along the process.</p>
</div>
<div class="paragraph">
<p><a href="https://drive.google.com/file/d/0B8N265C555thOG5HZDRTOTEtUXM/view?usp=sharing" class="bare">https://drive.google.com/file/d/0B8N265C555thOG5HZDRTOTEtUXM/view?usp=sharing</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-02-06 11:01:15 EST
</div>
</div>
</body>
</html>